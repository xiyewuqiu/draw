<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI画图生成器 - 释放你的创意，选择多种AI模型为你呈现艺术之美">
    <meta name="keywords" content="AI画图,人工智能,图像生成,DALL-E 3,Grok AI,Flux.1-dev,Stable Diffusion">
    <meta name="author" content="AI画图生成器">
    <meta name="theme-color" content="#7c5dfa">
    
    <title>AI画图生成器 - 释放创意 | 多模型支持</title>
    
    <!-- 网站图标 -->
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/svgs/solid/paintbrush.svg">
    
    <!-- Font Awesome 图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    
    <!-- 预连接常用域名，加速资源加载 -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <!-- Google Fonts - 可选，添加更多字体选择 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap">
    <style>
        :root {
            --primary-color: #7c5dfa;
            --primary-light: #9d89fc;
            --primary-gradient: linear-gradient(135deg, #7c5dfa, #9d89fc);
            --secondary-color: #ff8a00;
            --secondary-light: #ffaa33;
            --secondary-gradient: linear-gradient(135deg, #ff8a00, #ffaa33);
            --dark-color: #252945;
            --dark-gradient: linear-gradient(135deg, #252945, #373b64);
            --light-color: #f8f9fa;
            --white: #ffffff;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --success-color: #38bec9;
            --success-gradient: linear-gradient(135deg, #38bec9, #5eead4);
            --error-color: #ef4565;
            --error-gradient: linear-gradient(135deg, #ef4565, #ff6b8b);
            --card-shadow: 0 8px 30px rgba(0,0,0,0.12);
            --btn-shadow: 0 4px 14px rgba(124, 93, 250, 0.4);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --border-radius: 12px;
            --panel-radius: 16px;
            
            /* 背景和文本颜色 */
            --bg-color: #f9fafe;
            --text-color: #252945;
            --panel-bg: #ffffff;
            --skeleton-bg: #f0f0f0;
            --skeleton-highlight: #f8f8f8;
            --border-color: #e5e7eb;
        }
        
        /* 深色模式变量 */
        [data-theme="dark"] {
            --bg-color: #1a1c2d;
            --text-color: #f3f4f6;
            --panel-bg: #252945;
            --skeleton-bg: #2d324d;
            --skeleton-highlight: #313859;
            --border-color: #3a3f5f;
            --gray-100: #2d324d;
            --gray-200: #3a3f5f;
            --gray-300: #444b6e;
            --gray-400: #7782b9;
            --card-shadow: 0 8px 30px rgba(0,0,0,0.3);
        }
        
        /* 深色模式梦幻紫主题变量 */
        .dark-mode {
            --primary-color: #b388ff;
            --primary-light: #ccabff;
            --primary-gradient: linear-gradient(135deg, #9d65ff, #b388ff);
            --secondary-color: #ff78d7;
            --secondary-light: #ff9ce6;
            --secondary-gradient: linear-gradient(135deg, #ff78d7, #ff9ce6);
            
            --bg-color: #131028;
            --text-color: #f2f0ff;
            --panel-bg: #1d1a36;
            --skeleton-bg: #2a2649;
            --skeleton-highlight: #372e5f;
            --border-color: #342b63;
            --gray-100: #2a2649;
            --gray-200: #342b63;
            --gray-300: #4d3e8a;
            --gray-400: #8479ba;
            --card-shadow: 0 8px 30px rgba(97, 65, 216, 0.2);
            --btn-shadow: 0 4px 14px rgba(179, 136, 255, 0.4);
            --success-color: #64ffda;
            --success-gradient: linear-gradient(135deg, #64ffda, #8affb4);
            --error-color: #ff5e99;
            --error-gradient: linear-gradient(135deg, #ff5e99, #ff7eb3);
        }
        
        /* 深色模式下的星空背景 */
        .dark-mode body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(2px 2px at 40px 60px, #b388ff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 20px 50px, #ccabff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 30px 100px, #d0bcff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 40px 60px, #ff78d7, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 110px 90px, #b388ff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 190px 150px, #ccabff, rgba(0,0,0,0)),
                radial-gradient(circle at right top, rgba(157, 101, 255, 0.1), transparent 50%),
                radial-gradient(circle at left bottom, rgba(255, 120, 215, 0.1), transparent 50%);
            background-size: 300px 300px, 200px 200px, 250px 250px, 350px 350px, 400px 400px, 500px 500px, 100% 100%, 100% 100%;
            background-attachment: fixed;
            z-index: -1;
            pointer-events: none;
            opacity: 0.5;
        }
        
        /* 深色模式下的发光效果 */
        .dark-mode .create-panel,
        .dark-mode .result-panel,
        .dark-mode .tabs,
        .dark-mode .modal-content {
            box-shadow: 0 10px 30px rgba(97, 65, 216, 0.2),
                        0 0 20px rgba(179, 136, 255, 0.1);
            border: 1px solid rgba(179, 136, 255, 0.15);
        }
        
        .dark-mode .button {
            box-shadow: 0 10px 25px rgba(179, 136, 255, 0.4),
                        0 0 15px rgba(179, 136, 255, 0.2);
        }
        
        .dark-mode .button:hover {
            box-shadow: 0 15px 30px rgba(179, 136, 255, 0.5),
                        0 0 20px rgba(179, 136, 255, 0.3);
        }
        
        .dark-mode .filter-btn.active {
            box-shadow: 0 5px 15px rgba(179, 136, 255, 0.3),
                        0 0 10px rgba(179, 136, 255, 0.2);
        }
        
        .dark-mode .gallery-item:hover {
            box-shadow: 0 20px 40px rgba(97, 65, 216, 0.25),
                        0 0 15px rgba(179, 136, 255, 0.15);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes shimmer {
            0% { background-position: -500px 0; }
            100% { background-position: 500px 0; }
        }
        
        @keyframes fadeInRight {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes fadeInLeft {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0px); }
        }
        
        @keyframes borderPulse {
            0% { box-shadow: 0 0 0 0 rgba(124, 93, 250, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(124, 93, 250, 0); }
            100% { box-shadow: 0 0 0 0 rgba(124, 93, 250, 0); }
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            opacity: 0;
            transition: opacity 0.5s ease, background-color 0.3s ease;
        }
        
        body.loaded {
            opacity: 1;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(157, 137, 252, 0.1), transparent 70%),
                        radial-gradient(circle at bottom left, rgba(56, 190, 201, 0.1), transparent 70%);
            z-index: -1;
            pointer-events: none;
        }
        
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
            position: relative;
        }
        
        .header {
            text-align: center;
            margin-bottom: 3.5rem;
            animation: fadeIn 0.8s ease-out;
            position: relative;
            padding: 2rem 0;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(124, 93, 250, 0.1) 0%, rgba(124, 93, 250, 0) 70%);
            border-radius: 50%;
            z-index: -1;
        }
        
        .header h1 {
            color: var(--dark-color);
            font-size: 3.5rem;
            margin-bottom: 0.8rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 50%, var(--secondary-color) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
            display: inline-block;
            text-shadow: 0 10px 20px rgba(124, 93, 250, 0.1);
            animation: fadeInScale 1s ease-out;
        }
        
        .header h1::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -12px;
            width: 100px;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            transform: translateX(-50%);
            box-shadow: 0 2px 10px rgba(124, 93, 250, 0.3);
        }
        
        .header p {
            color: var(--gray-400);
            font-size: 1.25rem;
            max-width: 680px;
            margin: 2rem auto 0;
            font-weight: 400;
            line-height: 1.8;
            animation: fadeIn 1s ease-out 0.3s both;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 3rem;
            border-radius: var(--panel-radius);
            overflow: hidden;
            background: var(--panel-bg);
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            position: relative;
            padding: 0.6rem;
            border: 1px solid var(--border-color);
            animation: fadeIn 0.6s ease-out 0.2s both;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .tab-btn {
            flex: 1;
            background: transparent;
            color: var(--gray-400);
            padding: 1.2rem 0;
            text-align: center;
            font-size: 1.15rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            border-radius: 12px;
            transition: var(--transition);
            position: relative;
            z-index: 2;
        }
        
        .tab-btn:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .tab-btn.active {
            color: var(--white);
            transform: translateY(0);
        }
        
        .tabs::before {
            content: '';
            position: absolute;
            top: 0.6rem;
            left: 0.6rem;
            right: calc(100% - 0.6rem - (100% - 1.2rem) / 3);
            bottom: 0.6rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 12px;
            transition: var(--transition);
            z-index: 1;
            box-shadow: 0 5px 15px rgba(124, 93, 250, 0.3);
        }
        
        .tabs.gallery-active::before {
            left: calc(0.6rem + (100% - 1.2rem) / 3);
            right: calc(100% - 0.6rem - 2 * (100% - 1.2rem) / 3);
        }
        
        .tabs.compare-active::before {
            left: calc(0.6rem + 2 * (100% - 1.2rem) / 3);
            right: 0.6rem;
        }
        
        .tab-btn i {
            margin-right: 10px;
            font-size: 1.2em;
            vertical-align: -2px;
            transition: var(--transition);
        }
        
        .tab-btn:hover i {
            transform: scale(1.2);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.6s ease-out;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .create-panel {
            background: var(--panel-bg);
            border-radius: var(--panel-radius);
            box-shadow: var(--card-shadow);
            padding: 2.5rem;
            margin-bottom: 2.5rem;
            border: 1px solid var(--border-color);
            animation: fadeIn 0.8s ease-out 0.3s both;
        }
        
        .form-group {
            margin-bottom: 2.5rem;
            position: relative;
            transition: var(--transition);
            z-index: 1;
        }
        
        .form-group:nth-child(odd) {
            animation: fadeInLeft 0.7s ease-out 0.5s both;
        }
        
        .form-group:nth-child(even) {
            animation: fadeInRight 0.7s ease-out 0.6s both;
        }
        
        .form-group:hover label {
            color: var(--primary-color);
        }
        
        .form-group:hover label i {
            transform: scale(1.1);
        }
        
        label {
            display: block;
            margin-bottom: 0.8rem;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 1.1rem;
            position: relative;
            padding-left: 1.5rem;
            transition: var(--transition);
        }
        
        label i {
            position: absolute;
            left: 0;
            top: 0.2rem;
            color: var(--primary-color);
            transition: var(--transition);
        }
        
        .input-area {
            width: 100%;
            padding: 1.4rem;
            border: 2px solid var(--border-color);
            border-radius: var(--panel-radius);
            font-size: 1.05rem;
            transition: var(--transition);
            resize: vertical;
            min-height: 160px;
            background: var(--panel-bg);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.04);
            font-family: inherit;
            color: var(--text-color);
        }
        
        .input-area:hover {
            border-color: var(--gray-300);
        }
        
        .input-area:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 4px rgba(124, 93, 250, 0.15);
            transform: translateY(-2px);
        }
        
        .input-area:focus + label i {
            transform: scale(1.2);
            color: var(--primary-color);
        }
        
        select {
            width: 100%;
            padding: 1.4rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--panel-radius);
            font-size: 1.05rem;
            background: var(--white);
            transition: var(--transition);
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg fill="%239ca3af" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
            background-repeat: no-repeat;
            background-position: right 1rem center;
            cursor: pointer;
            font-family: inherit;
            color: var(--dark-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
        }
        
        select:hover {
            border-color: var(--gray-300);
        }
        
        select:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 4px rgba(124, 93, 250, 0.15);
            transform: translateY(-2px);
        }
        
        .button {
            display: block;
            width: 100%;
            padding: 1.4rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--white);
            border: none;
            border-radius: var(--panel-radius);
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 10px 25px rgba(124, 93, 250, 0.4);
            position: relative;
            overflow: hidden;
            font-family: inherit;
            text-transform: uppercase;
            letter-spacing: 1px;
            z-index: 1;
            animation: fadeIn 0.8s ease-out 0.7s both;
        }
        
        .button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s ease-out;
            z-index: -1;
        }
        
        .button::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            opacity: 0;
            transition: opacity 0.5s ease;
            z-index: -2;
        }
        
        .button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(124, 93, 250, 0.5);
        }
        
        .button:hover::before {
            left: 100%;
            transition: 0.7s;
        }
        
        .button:hover::after {
            opacity: 1;
        }
        
        .button:active {
            transform: translateY(0);
            box-shadow: 0 5px 15px rgba(124, 93, 250, 0.4);
        }
        
        .button:disabled {
            background: var(--gray-300);
            transform: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            cursor: not-allowed;
        }
        
        .button i {
            margin-right: 10px;
            font-size: 1.2em;
            vertical-align: -2px;
            transition: transform 0.3s ease;
        }
        
        .button:hover i {
            transform: translateX(-3px);
            animation: float 2s ease-in-out infinite;
        }
        
        .result-panel {
            background: var(--panel-bg);
            border-radius: var(--panel-radius);
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            padding: 3rem;
            text-align: center;
            display: none;
            margin-top: 3rem;
            border: 1px solid var(--border-color);
            animation: fadeIn 0.8s ease-out;
            position: relative;
            overflow: hidden;
        }
        
        .result-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }
        
        .result-panel.active {
            display: block;
        }
        
        .loading {
            display: none;
            text-align: center;
            margin: 4rem 0;
        }
        
        .spinner {
            display: inline-block;
            width: 70px;
            height: 70px;
            border: 4px solid rgba(124, 93, 250, 0.1);
            border-radius: 50%;
            border-left-color: var(--primary-color);
            border-top-color: var(--secondary-color);
            animation: spin 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
            box-shadow: 0 5px 15px rgba(124, 93, 250, 0.2);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading p {
            margin-top: 2rem;
            font-size: 1.3rem;
            color: var(--gray-400);
            font-weight: 500;
            animation: pulse 1.5s infinite;
        }
        
        .error-message {
            background-color: rgba(239, 69, 101, 0.1);
            border-left: 4px solid var(--error-color);
            color: var(--error-color);
            padding: 1.2rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            display: none;
            font-weight: 500;
            animation: fadeIn 0.3s ease-out;
        }
        
        .revised-prompt {
            margin: 1.5rem 0 2.5rem;
            padding: 1.5rem;
            background-color: var(--gray-100);
            border-radius: 12px;
            font-style: italic;
            color: var(--dark-color);
            border-left: 4px solid var(--primary-light);
            display: none;
            text-align: left;
            animation: fadeIn 0.5s ease-out;
            line-height: 1.7;
        }

        .result-image-wrapper {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .result-image-container {
            padding: 0;
            position: relative;
            display: inline-block;
            width: 100%;
            max-width: 520px;
            border-radius: var(--panel-radius);
            overflow: hidden;
            transform: translateY(40px);
            opacity: 0;
            animation: fadeIn 0.7s ease-out forwards;
            animation-delay: calc(var(--delay) * 0.15s);
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .result-image-container:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.18);
        }
        
        .result-image {
            width: 100%;
            border-radius: var(--panel-radius);
            transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: block;
        }
        
        .result-image-container:hover .result-image {
            transform: scale(1.03);
        }
        
        .download-btn {
            position: absolute;
            bottom: 1.5rem;
            right: 1.5rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 50%;
            width: 52px;
            height: 52px;
            font-size: 1.3rem;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            opacity: 0;
            transform: scale(0.8) translateY(10px);
            z-index: 10;
        }
        
        .result-image-container:hover .download-btn {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
        
        .download-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(124, 93, 250, 0.5);
        }
        
        /* 画廊样式 */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
            gap: 2.5rem;
            margin-top: 3rem;
            animation: fadeIn 0.8s ease-out;
        }
        
        .gallery-item {
            background: var(--white);
            border-radius: var(--panel-radius);
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            border: 1px solid var(--gray-200);
            transform: translateY(40px);
            opacity: 0;
            animation: fadeIn 0.5s ease-out forwards;
            animation-delay: calc(var(--index) * 0.05s);
        }
        
        .gallery-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.12);
        }
        
        .gallery-image {
            width: 100%;
            height: 240px;
            object-fit: cover;
            display: block;
            transition: var(--transition);
        }
        
        .gallery-item:hover .gallery-image {
            transform: scale(1.04);
        }
        
        .gallery-content {
            padding: 1.5rem;
        }
        
        .gallery-model {
            font-size: 0.9rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 0.8rem;
            display: block;
            padding: 0.4rem 0.8rem;
            background-color: rgba(124, 93, 250, 0.1);
            border-radius: 20px;
            display: inline-block;
        }
        
        .gallery-prompt {
            font-size: 1rem;
            margin-bottom: 1.2rem;
            color: var(--dark-color);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.5;
            font-weight: 500;
        }
        
        .gallery-time {
            font-size: 0.85rem;
            color: var(--gray-400);
        }
        
        .gallery-actions {
            display: flex;
            justify-content: center;
            margin-top: 1.2rem;
            padding-top: 1.2rem;
            border-top: 1px solid var(--gray-200);
        }
        
        .gallery-btn {
            background: none;
            border: none;
            color: var(--dark-color);
            cursor: pointer;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            transition: var(--transition);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 500;
        }
        
        .gallery-btn i {
            margin-right: 6px;
        }
        
        .gallery-btn:hover {
            color: var(--primary-color);
            background-color: rgba(124, 93, 250, 0.1);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--white);
            border-radius: var(--panel-radius);
            max-width: 90%;
            max-height: 90%;
            overflow: auto;
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            transform: scale(0.9);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        .modal.active .modal-content {
            transform: scale(1);
        }
        
        .modal-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 1.5rem;
            color: var(--dark-color);
            font-weight: 700;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--gray-400);
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .modal-close:hover {
            color: var(--error-color);
            background-color: rgba(239, 69, 101, 0.1);
        }
        
        .modal-body {
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.8rem;
        }
        
        .modal-image {
            max-width: 100%;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .modal-details {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .modal-prompt {
            padding: 1.5rem;
            background: var(--gray-100);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-light);
            line-height: 1.7;
            color: var(--dark-color);
        }
        
        .modal-info {
            display: flex;
            justify-content: space-between;
            color: var(--gray-400);
            font-size: 0.95rem;
            padding: 0.5rem 0;
        }
        
        .empty-gallery {
            text-align: center;
            padding: 6rem 3rem;
            color: var(--gray-400);
            font-size: 1.2rem;
            background: var(--white);
            border-radius: var(--panel-radius);
            box-shadow: var(--card-shadow);
            margin-top: 2rem;
            border: 1px solid var(--gray-200);
            animation: fadeIn 0.6s ease-out;
        }
        
        .empty-gallery i {
            font-size: 5rem;
            margin-bottom: 1.5rem;
            display: block;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* 响应式调整 */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 1.5rem;
            }
            
            .create-panel,
            .result-panel {
                padding: 1.5rem;
            }
            
            .form-group-split {
                flex-direction: column;
            }
            
            .form-group-split .form-group {
                width: 100%;
                padding: 0;
            }
        }
        
        /* 响应式设计 */
        @media (max-width: 1200px) {
            .app-container {
                padding: 1.5rem;
            }
            
            .create-panel, 
            .result-panel {
                padding: 2.5rem;
            }
        }
        
        @media (max-width: 992px) {
            .header h1 {
                font-size: 3rem;
            }
            
            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
            
            .form-group-split .form-group {
                padding: 0 0.5rem;
            }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .header p {
                font-size: 1.1rem;
                max-width: 100%;
            }
            
            .tabs {
                max-width: 100%;
            }
            
            .tab-btn {
                padding: 1rem 0;
                font-size: 1rem;
            }
            
            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 1.5rem;
                margin-top: 2rem;
            }
            
            .create-panel,
            .result-panel {
                padding: 1.5rem;
                margin-bottom: 2rem;
            }
            
            .form-group {
                margin-bottom: 2rem;
            }
            
            label {
                font-size: 1rem;
            }
            
            .input-area, select {
                padding: 1.2rem;
                font-size: 1rem;
            }
            
            .button {
                padding: 1.2rem;
                font-size: 1.1rem;
            }
            
            .form-group-split {
                flex-direction: column;
            }
            
            .form-group-split .form-group {
                width: 100%;
                padding: 0;
                margin-bottom: 1.5rem;
            }
            
            .advanced-options,
            .flux-options,
            .grok-options,
            .boodlebox-options {
                padding: 1.2rem;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header::before {
                width: 100px;
                height: 100px;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .create-panel,
            .result-panel {
                padding: 1.2rem;
                border-radius: 12px;
            }
            
            .tab-btn i {
                margin-right: 5px;
            }
            
            .spinner {
                width: 50px;
                height: 50px;
            }
            
            .loading p {
                font-size: 1.1rem;
                margin-top: 1.5rem;
            }
            
            .result-image-container {
                max-width: 100%;
            }
            
            .download-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
                bottom: 1rem;
                right: 1rem;
            }
            
            /* 移动端优化 */
            .theme-switch {
                bottom: 15px;
                right: 15px;
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }
            
            .gallery-filters {
                padding: 0 10px;
                overflow-x: auto;
                flex-wrap: nowrap;
                justify-content: flex-start;
                -webkit-overflow-scrolling: touch;
                padding-bottom: 10px;
                gap: 0.5rem;
            }
            
            .filter-btn {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
                white-space: nowrap;
            }
            
            .gallery-search input {
                padding: 1rem 1.5rem;
                padding-left: 2.8rem;
                font-size: 0.95rem;
            }
            
            .gallery-search i {
                left: 1rem;
                font-size: 1.1rem;
            }
            
            /* 底部固定式导航 */
            .mobile-nav {
                display: flex;
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                background: var(--panel-bg);
                box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
                z-index: 99;
                padding: 10px 0 calc(10px + env(safe-area-inset-bottom, 0));
                border-top: 1px solid var(--border-color);
            }
            
            .mobile-nav-btn {
                flex: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                color: var(--gray-400);
                font-size: 0.8rem;
                padding: 8px;
                border: none;
                background: none;
                transition: all 0.3s ease;
                cursor: pointer;
            }
            
            .mobile-nav-btn i {
                font-size: 1.3rem;
                margin-bottom: 5px;
            }
            
            .mobile-nav-btn.active {
                color: var(--primary-color);
            }
            
            .app-container {
                padding-bottom: 80px;
            }
            
            /* 移动端底部安全区域 */
            @supports (padding: max(0px)) {
                .mobile-nav {
                    padding-bottom: max(10px, env(safe-area-inset-bottom));
                }
                
                .app-container {
                    padding-bottom: calc(80px + env(safe-area-inset-bottom, 0px));
                }
            }
        }
        
        .gallery-header {
            text-align: center;
            margin-bottom: 2.5rem;
            animation: fadeIn 0.6s ease-out 0.2s both;
        }
        
        .gallery-header h2 {
            color: var(--dark-color);
            font-size: 2.2rem;
            margin-bottom: 0.8rem;
            font-weight: 700;
            position: relative;
            display: inline-block;
        }
        
        .gallery-header h2::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -8px;
            width: 60px;
            height: 3px;
            background: var(--primary-gradient);
            border-radius: 2px;
            transform: translateX(-50%);
        }
        
        .gallery-header p {
            color: var(--gray-400);
            font-size: 1.1rem;
        }
        
        /* 画廊筛选器样式 */
        .gallery-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin: 2rem auto;
            justify-content: center;
            max-width: 800px;
        }
        
        .filter-btn {
            padding: 0.7rem 1.2rem;
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 30px;
            color: var(--text-color);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .filter-btn.active {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            box-shadow: 0 5px 15px rgba(124, 93, 250, 0.3);
        }
        
        .filter-btn i {
            margin-right: 5px;
            font-size: 0.9em;
        }
        
        .gallery-search {
            display: flex;
            max-width: 600px;
            margin: 0 auto 2rem;
            position: relative;
        }
        
        .gallery-search input {
            flex: 1;
            padding: 1.2rem 1.5rem;
            padding-left: 3rem;
            border: 1px solid var(--border-color);
            border-radius: 50px;
            background: var(--panel-bg);
            color: var(--text-color);
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        
        .gallery-search input:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 5px 20px rgba(124, 93, 250, 0.15);
        }
        
        .gallery-search i {
            position: absolute;
            left: 1.2rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
            font-size: 1.2rem;
        }
        
        .no-results {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--gray-400);
            font-size: 1.2rem;
            background: var(--panel-bg);
            border-radius: var(--panel-radius);
            border: 1px solid var(--border-color);
            margin-top: 2rem;
        }
        
        .no-results i {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
            opacity: 0.5;
        }
        
        .advanced-options,
        .grok-options,
        .flux-options {
            background: var(--gray-100);
            padding: 1.8rem;
            margin-top: 1.5rem;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-light);
            display: none;
            animation: fadeIn 0.4s ease-out;
        }
        
        .advanced-options.active,
        .grok-options.active,
        .flux-options.active {
            display: block;
        }
        
        .advanced-toggle,
        .grok-toggle,
        .flux-toggle,
        .boodlebox-toggle {
            display: flex;
            align-items: center;
            margin-top: 1.2rem;
            margin-bottom: 1.5rem;
            font-size: 1rem;
            color: var(--primary-color);
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.8rem 1.2rem;
            border-radius: var(--border-radius);
            font-weight: 500;
            border: 1px solid rgba(124, 93, 250, 0.2);
            transition: var(--transition);
        }
        
        .advanced-toggle:hover,
        .grok-toggle:hover,
        .flux-toggle:hover,
        .boodlebox-toggle:hover {
            background: rgba(124, 93, 250, 0.1);
        }
        
        .advanced-toggle i,
        .grok-toggle i,
        .flux-toggle i,
        .boodlebox-toggle i {
            margin-right: 8px;
            transition: transform 0.3s ease;
        }
        
        .advanced-toggle.active i,
        .grok-toggle.active i,
        .flux-toggle.active i,
        .boodlebox-toggle.active i {
            transform: rotate(180deg);
        }
        
        .option-row {
            display: flex;
            gap: 1.2rem;
            margin-bottom: 1.2rem;
        }
        
        .option-col {
            flex: 1;
        }
        
        .option-label {
            font-size: 0.9rem;
            margin-bottom: 0.6rem;
            display: block;
            color: var(--dark-color);
            font-weight: 500;
        }
        
        .option-select, 
        .option-input {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 0.95rem;
            background: var(--white);
            transition: var(--transition);
            font-family: inherit;
        }
        
        .option-select:focus,
        .option-input:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(124, 93, 250, 0.1);
        }
        
        .options-note {
            font-size: 0.85rem;
            color: var(--gray-400);
            margin-top: 1rem;
            font-style: italic;
            line-height: 1.6;
        }
        
        /* Grok参数选项 */
        .grok-options {
            border-left: 4px solid var(--secondary-color);
        }
        
        .grok-toggle {
            color: var(--secondary-color);
            border-color: rgba(255, 138, 0, 0.2);
        }
        
        .grok-toggle:hover {
            background: rgba(255, 138, 0, 0.1);
        }
                
        /* 自定义滚动条 */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--gray-300);
            border-radius: 10px;
            transition: var(--transition);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-400);
        }
        
        /* 输入框的占位符样式 */
        ::placeholder {
            color: var(--gray-400);
            opacity: 0.7;
        }
        
        /* 选择文本的样式 */
        ::selection {
            background: rgba(124, 93, 250, 0.2);
            color: var(--primary-color);
        }
        
        /* 表单焦点增强效果 */
        .form-group::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transition: all 0.4s ease;
            transform: translateX(-50%);
            opacity: 0;
            border-radius: 10px;
            z-index: -1;
        }
        
        .form-group.focus::after {
            width: 80%;
            opacity: 1;
        }
        
        /* 动画添加 */
        .form-group:nth-child(1) {
            animation: fadeInLeft 0.5s ease-out 0.3s both;
        }
        
        .form-group:nth-child(2) {
            animation: fadeInRight 0.5s ease-out 0.4s both;
        }
        
        .form-group:nth-child(3) {
            animation: fadeInLeft 0.5s ease-out 0.5s both;
        }
        
        .form-group:nth-child(4) {
            animation: fadeInRight 0.5s ease-out 0.6s both;
        }
        
        .button {
            animation: fadeIn 0.5s ease-out 0.7s both;
        }
        
        .result-image-container:nth-child(1) {
            animation-delay: 0.1s;
        }
        
        .result-image-container:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .result-image-container:nth-child(3) {
            animation-delay: 0.3s;
        }
        
        .result-image-container:nth-child(4) {
            animation-delay: 0.4s;
        }
        
        /* 添加输入框焦点动画 */
        .input-area:focus, select:focus {
            animation: borderPulse 1.5s infinite;
        }
        
        /* 按钮涟漪效果 */
        .button {
            position: relative;
            overflow: hidden;
        }
        
        .ripple-effect {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            transform: scale(0);
            animation: ripple 0.6s linear;
            pointer-events: none;
        }
        
        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        /* 页面加载动画 */
        body {
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        body.loaded {
            opacity: 1;
        }
        
        /* 图片加载骨架屏 */
        .image-skeleton {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, #f0f0f0 25%, #f8f8f8 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: var(--panel-radius);
            z-index: 1;
        }
        
        .result-image.loaded + .image-skeleton {
            display: none;
        }
        
        .image-loading-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--primary-color);
            font-size: 2rem;
            z-index: 2;
            opacity: 0.7;
        }
        
        .result-image.loaded ~ .image-loading-icon {
            display: none;
        }
        
        .gallery-image-container {
            position: relative;
            width: 100%;
            height: 240px;
            overflow: hidden;
        }
        
        .gallery-image {
            width: 100%;
            height: 240px;
            object-fit: cover;
            display: block;
            transition: var(--transition);
            position: relative;
            z-index: 2;
        }
        
        .gallery-item:hover .gallery-image {
            transform: scale(1.04);
        }
        
        .gallery-image.loaded + .image-skeleton,
        .gallery-image.loaded ~ .image-loading-icon {
            display: none;
        }
        
        /* 深色模式切换按钮 */
        .theme-switch {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 100;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: none;
            font-size: 1.5rem;
        }
        
        .theme-switch:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .dark-mode-icon {
            display: block;
        }
        
        .light-mode-icon {
            display: none;
        }
        
        .dark-mode .dark-mode-icon {
            display: none;
        }
        
        .dark-mode .light-mode-icon {
            display: block;
        }
        
        /* 深色模式装饰元素和动画 */
        @keyframes dreamy-float {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.5; }
            50% { transform: translateY(-15px) rotate(5deg); opacity: 0.7; }
            100% { transform: translateY(0) rotate(0deg); opacity: 0.5; }
        }
        
        @keyframes dreamy-glow {
            0% { box-shadow: 0 0 5px rgba(179, 136, 255, 0.3); }
            50% { box-shadow: 0 0 20px rgba(179, 136, 255, 0.6); }
            100% { box-shadow: 0 0 5px rgba(179, 136, 255, 0.3); }
        }
        
        @keyframes color-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .dark-mode .header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 20% 30%, rgba(179, 136, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 120, 215, 0.1) 0%, transparent 50%);
            filter: blur(40px);
            pointer-events: none;
        }
        
        .dark-mode .header h1 {
            text-shadow: 0 0 10px rgba(179, 136, 255, 0.5);
            background: linear-gradient(to right, #b388ff, #ff78d7, #ccabff, #ff9ce6);
            background-size: 300% 100%;
            animation: color-shift 8s ease infinite;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .dark-mode .header h1::after {
            background: linear-gradient(90deg, #b388ff, #ff78d7);
            box-shadow: 0 0 15px rgba(179, 136, 255, 0.7);
        }
        
        /* 悬浮光点特效 */
        .dark-mode .app-container::before {
            content: '';
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(179, 136, 255, 0.2) 0%, transparent 70%);
            top: 20%;
            left: 15%;
            filter: blur(20px);
            animation: dreamy-float 15s ease-in-out infinite;
        }
        
        .dark-mode .app-container::after {
            content: '';
            position: absolute;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 120, 215, 0.15) 0%, transparent 70%);
            top: 60%;
            right: 10%;
            filter: blur(25px);
            animation: dreamy-float 20s ease-in-out infinite reverse;
        }
        
        /* 输入框特效 */
        .dark-mode .input-area:focus,
        .dark-mode select:focus {
            border-color: rgba(179, 136, 255, 0.6);
            box-shadow: 0 0 15px rgba(179, 136, 255, 0.4);
            animation: dreamy-glow 2s infinite;
        }
        
        .dark-mode .tabs::before {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 0 20px rgba(179, 136, 255, 0.4);
        }
        
        /* 深色模式下的按钮颜色过渡 */
        .dark-mode .button {
            background: linear-gradient(135deg, #9d65ff, #ff78d7);
            background-size: 200% 100%;
            animation: color-shift 8s ease infinite;
        }
        
        .dark-mode .button::after {
            background: linear-gradient(135deg, #ff78d7, #9d65ff);
            background-size: 200% 100%;
        }
        
        /* 画廊项目特效 */
        .dark-mode .gallery-item {
            border: 1px solid rgba(179, 136, 255, 0.2);
            background: linear-gradient(to bottom, 
                rgba(45, 38, 80, 0.8), 
                rgba(29, 26, 54, 0.9)
            );
            backdrop-filter: blur(10px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .dark-mode .gallery-item:hover {
            transform: translateY(-12px);
            border: 1px solid rgba(179, 136, 255, 0.4);
        }
        
        .dark-mode .gallery-model {
            background-color: rgba(179, 136, 255, 0.2);
            color: var(--primary-light);
            box-shadow: 0 0 10px rgba(179, 136, 255, 0.2);
        }
        
        .dark-mode .gallery-prompt {
            color: rgba(242, 240, 255, 0.9);
        }
        
        .dark-mode .gallery-btn:hover {
            color: var(--primary-light);
            background-color: rgba(179, 136, 255, 0.2);
        }
        
        /* 结果面板特效 */
        .dark-mode .result-panel::before {
            height: 6px;
            background: linear-gradient(90deg, #b388ff, #ff78d7);
            box-shadow: 0 0 15px rgba(179, 136, 255, 0.5);
        }
        
        .dark-mode .result-image-container {
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(97, 65, 216, 0.25);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(179, 136, 255, 0.15);
        }
        
        .dark-mode .result-image-container:hover {
            transform: translateY(-15px) scale(1.02);
            border: 1px solid rgba(179, 136, 255, 0.3);
            box-shadow: 0 20px 40px rgba(97, 65, 216, 0.3),
                        0 0 25px rgba(179, 136, 255, 0.2);
        }
        
        .dark-mode .download-btn {
            background: linear-gradient(135deg, #b388ff, #ff78d7);
            box-shadow: 0 8px 25px rgba(179, 136, 255, 0.4);
        }
        
        .dark-mode .download-btn:hover {
            box-shadow: 0 10px 30px rgba(179, 136, 255, 0.6),
                        0 0 15px rgba(179, 136, 255, 0.4);
            transform: scale(1.15) rotate(5deg);
        }
        
        /* 搜索和筛选特效 */
        .dark-mode .gallery-search input {
            background: rgba(29, 26, 54, 0.8);
            border: 1px solid rgba(179, 136, 255, 0.2);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
            color: var(--text-color);
        }
        
        .dark-mode .gallery-search input:focus {
            border-color: rgba(179, 136, 255, 0.5);
            box-shadow: 0 0 15px rgba(179, 136, 255, 0.3),
                        inset 0 0 10px rgba(0, 0, 0, 0.2);
        }
        
        .dark-mode .gallery-search i {
            color: var(--primary-light);
        }
        
        .dark-mode .filter-btn {
            background: rgba(29, 26, 54, 0.8);
            border: 1px solid rgba(179, 136, 255, 0.15);
            backdrop-filter: blur(5px);
        }
        
        .dark-mode .filter-btn:hover {
            border-color: rgba(179, 136, 255, 0.3);
            box-shadow: 0 5px 15px rgba(179, 136, 255, 0.2);
            background: rgba(45, 38, 80, 0.8);
        }
        
        .dark-mode .filter-btn.active {
            background: linear-gradient(135deg, rgba(157, 101, 255, 0.9), rgba(255, 120, 215, 0.9));
            border: none;
        }
        
        /* 杂项美化 */
        .dark-mode .image-loading-icon {
            color: var(--primary-light);
        }
        
        .dark-mode .mobile-nav {
            background: rgba(29, 26, 54, 0.8);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(179, 136, 255, 0.2);
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.3);
        }
        
        .dark-mode .mobile-nav-btn.active {
            color: var(--primary-light);
            text-shadow: 0 0 10px rgba(179, 136, 255, 0.5);
        }
        
        /* 动态背景特效 */
        @keyframes gradient-move {
            0% { transform: translate(0, 0); }
            50% { transform: translate(-20px, -15px); }
            100% { transform: translate(0, 0); }
        }
        
        @keyframes shooting-star {
            0% { 
                transform: translateX(0) translateY(0) rotate(315deg);
                opacity: 0;
            }
            15% { opacity: 1; }
            70% { opacity: 1; }
            100% { 
                transform: translateX(-500px) translateY(500px) rotate(315deg);
                opacity: 0;
            }
        }
        
        /* 流动的渐变背景 */
        .dark-mode .app-container {
            position: relative;
        }
        
        .dark-mode .app-container::before, 
        .dark-mode .app-container::after {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -2;
            opacity: 0.1;
            pointer-events: none;
        }
        
        .dark-mode .app-container::before {
            background: 
                radial-gradient(circle at 20% 10%, rgba(157, 101, 255, 0.5), transparent 40%),
                radial-gradient(circle at 80% 20%, rgba(255, 120, 215, 0.4), transparent 40%),
                radial-gradient(circle at 10% 80%, rgba(100, 255, 218, 0.3), transparent 30%),
                radial-gradient(circle at 80% 90%, rgba(157, 101, 255, 0.4), transparent 50%);
            filter: blur(40px);
            animation: gradient-move 20s ease-in-out infinite alternate;
        }
        
        .dark-mode .app-container::after {
            background:
                radial-gradient(circle at 70% 50%, rgba(255, 156, 230, 0.3), transparent 30%),
                radial-gradient(circle at 30% 60%, rgba(179, 136, 255, 0.3), transparent 40%);
            filter: blur(60px);
            animation: gradient-move 15s ease-in-out infinite alternate-reverse;
        }
        
        /* 流星效果 */
        .shooting-star {
            position: fixed;
            width: 100px;
            height: 2px;
            background: linear-gradient(to right, transparent, #ccabff, #b388ff, transparent);
            box-shadow: 0 0 10px #b388ff;
            border-radius: 50%;
            z-index: -1;
            opacity: 0;
            pointer-events: none;
        }
        
        /* 给星星添加尾巴 */
        .shooting-star::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 2px;
            background: linear-gradient(to right, transparent, #ccabff);
            border-radius: 50%;
            box-shadow: 0 0 5px #ccabff;
        }
        
        .dark-mode .shooting-star:nth-child(1) {
            top: 15%;
            right: 10%;
            animation: shooting-star 8s linear infinite;
            animation-delay: 0s;
        }
        
        .dark-mode .shooting-star:nth-child(2) {
            top: 35%;
            right: 20%;
            animation: shooting-star 10s linear infinite;
            animation-delay: 3s;
        }
        
        .dark-mode .shooting-star:nth-child(3) {
            top: 65%;
            right: 15%;
            animation: shooting-star 7s linear infinite;
            animation-delay: 6s;
        }
        
        .prompt-suggestions {
            margin-top: 1rem;
            background: var(--bg-color);
            border-radius: 10px;
            padding: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: var(--transition);
        }
        
        .suggestion-title {
            font-size: 0.95rem;
            color: var(--primary-color);
            margin-bottom: 0.8rem;
            font-weight: 600;
        }
        
        .suggestion-title i {
            margin-right: 6px;
            animation: pulse 2s infinite;
        }
        
        .suggestion-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
        }
        
        .suggestion-tag {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 10px rgba(124, 93, 250, 0.2);
            user-select: none;
        }
        
        .suggestion-tag:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(124, 93, 250, 0.3);
        }
        
        .dark-mode .prompt-suggestions {
            background: var(--panel-bg);
            border-color: var(--border-color);
        }
        
        .dark-mode .suggestion-tag {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            box-shadow: 0 4px 10px rgba(179, 136, 255, 0.3);
        }
        
        .dark-mode .suggestion-tag:hover {
            box-shadow: 0 6px 15px rgba(179, 136, 255, 0.4);
        }
        
        .model-selection-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .model-selection-wrapper select {
            flex: 1;
        }
        
        .style-preview-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-left: 12px;
            box-shadow: 0 5px 15px rgba(124, 93, 250, 0.3);
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .style-preview-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(124, 93, 250, 0.4);
        }
        
        .style-preview-btn i {
            font-size: 1.2rem;
        }
        
        .style-modal-content {
            max-width: 850px;
            width: 90%;
        }
        
        .style-tabs {
            display: flex;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--gray-200);
            margin-bottom: 1.5rem;
            gap: 0.5rem;
        }
        
        .style-tab {
            padding: 0.8rem 1.2rem;
            background: transparent;
            border: none;
            color: var(--gray-400);
            cursor: pointer;
            font-weight: 600;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .style-tab:hover {
            color: var(--primary-color);
        }
        
        .style-tab.active {
            color: var(--primary-color);
        }
        
        .style-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary-gradient);
            border-radius: 10px 10px 0 0;
        }
        
        .style-panel {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }
        
        .style-panel.active {
            display: block;
        }
        
        .style-info {
            margin-bottom: 1.5rem;
        }
        
        .style-info h4 {
            color: var(--dark-color);
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }
        
        .style-info p {
            color: var(--gray-400);
            line-height: 1.6;
        }
        
        .style-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
        }
        
        .style-example-img {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .style-example-img:hover {
            transform: scale(1.03);
        }
        
        .dark-mode .style-tabs {
            border-color: var(--gray-200);
        }
        
        .dark-mode .style-tab {
            color: var(--gray-400);
        }
        
        .dark-mode .style-tab.active,
        .dark-mode .style-tab:hover {
            color: var(--primary-light);
        }
        
        .image-tools {
            position: absolute;
            bottom: 1.5rem;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 1.5rem;
            z-index: 5;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            margin-right: auto;
        }
        
        .share-btn {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            margin-left: auto;
        }
        
        .share-options {
            position: absolute;
            bottom: 5rem;
            right: 1.5rem;
            background: var(--panel-bg);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            padding: 1rem;
            z-index: 10;
            display: none;
            flex-direction: column;
            gap: 0.8rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            animation: fadeInScale 0.3s ease-out;
        }
        
        .share-options.active {
            display: flex;
        }
        
        .share-option {
            display: flex;
            align-items: center;
            padding: 0.8rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: var(--gray-100);
            color: var(--dark-color);
            text-decoration: none;
            font-weight: 500;
        }
        
        .share-option:hover {
            background: var(--gray-200);
            transform: translateX(5px);
        }
        
        .share-option i {
            margin-right: 10px;
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }
        
        .share-option.wechat i {
            color: #07C160;
        }
        
        .share-option.weibo i {
            color: #E6162D;
        }
        
        .share-option.qq i {
            color: #12B7F5;
        }
        
        .share-option.copy i {
            color: var(--primary-color);
        }
        
        .copy-success {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-size: 0.9rem;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: none;
        }
        
        .copy-success.active {
            display: block;
            animation: fadeInOut 2s ease-in-out forwards;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translate(-50%, -20px); }
            15% { opacity: 1; transform: translate(-50%, 0); }
            85% { opacity: 1; transform: translate(-50%, 0); }
            100% { opacity: 0; transform: translate(-50%, -20px); }
        }
        
        .dark-mode .share-options {
            background: var(--panel-bg);
            border-color: var(--border-color);
        }
        
        .dark-mode .share-option {
            background: var(--gray-100);
            color: var(--text-color);
        }
        
        .dark-mode .share-option:hover {
            background: var(--gray-200);
        }
        
        .prompt-tools {
            display: flex;
            margin-top: 1rem;
            gap: 1rem;
        }
        
        .prompt-tool-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 0.7rem 1.5rem;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(124, 93, 250, 0.2);
        }
        
        .prompt-tool-btn i {
            margin-right: 8px;
            font-size: 1.1rem;
        }
        
        .prompt-tool-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(124, 93, 250, 0.3);
        }
        
        .prompt-modal-content {
            max-width: 800px;
            width: 90%;
        }
        
        .prompt-assistant-intro {
            margin-bottom: 1.5rem;
            color: var(--gray-400);
            line-height: 1.6;
        }
        
        .assistant-sections {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .assistant-section-title {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            color: var(--dark-color);
        }
        
        .assistant-section-title i {
            margin-right: 8px;
            color: var(--primary-color);
        }
        
        .assistant-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
        }
        
        .assistant-chip {
            background: var(--gray-100);
            color: var(--dark-color);
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }
        
        .assistant-chip:hover {
            background: var(--gray-200);
            transform: translateY(-2px);
        }
        
        .assistant-chip.selected {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 5px 15px rgba(124, 93, 250, 0.2);
        }
        
        .assistant-preview {
            background: var(--gray-100);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .assistant-preview-title {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--dark-color);
        }
        
        .assistant-preview-content {
            background: var(--panel-bg);
            border-radius: 8px;
            padding: 1.2rem;
            min-height: 100px;
            border: 1px solid var(--border-color);
            color: var(--dark-color);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }
        
        .apply-prompt-btn {
            background: linear-gradient(135deg, var(--success-color) 0%, #5eead4 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(56, 190, 201, 0.3);
        }
        
        .apply-prompt-btn:disabled {
            background: var(--gray-300);
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none;
        }
        
        .apply-prompt-btn i {
            margin-right: 8px;
        }
        
        .apply-prompt-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(56, 190, 201, 0.4);
        }
        
        .dark-mode .assistant-chip {
            background: var(--gray-100);
            color: var(--text-color);
        }
        
        .dark-mode .assistant-chip:hover {
            background: var(--gray-200);
        }
        
        .dark-mode .assistant-preview {
            background: var(--gray-100);
        }
        
        .dark-mode .assistant-preview-content {
            background: var(--panel-bg);
            border-color: var(--border-color);
            color: var(--text-color);
        }
        
        /* 模型比较相关样式 */
        .compare-header {
            text-align: center;
            margin-bottom: 2.5rem;
        }
        
        .compare-header h2 {
            font-size: 2.2rem;
            color: var(--dark-color);
            margin-bottom: 0.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .compare-header p {
            color: var(--gray-400);
            font-size: 1.15rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .compare-panel {
            background: var(--panel-bg);
            border-radius: var(--panel-radius);
            box-shadow: var(--card-shadow);
            padding: 2.5rem;
            margin-bottom: 2.5rem;
            border: 1px solid var(--border-color);
            animation: fadeIn 0.8s ease-out;
        }
        
        .compare-subtitle {
            font-size: 1.3rem;
            color: var(--dark-color);
            margin: 1.5rem 0 1rem;
            display: flex;
            align-items: center;
        }
        
        .compare-subtitle i {
            margin-right: 10px;
            color: var(--primary-color);
        }
        
        .model-checkboxes {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 1rem;
        }
        
        .model-checkbox {
            display: flex;
            align-items: center;
            cursor: pointer;
            user-select: none;
            padding: 0.8rem 1.2rem;
            background: var(--gray-100);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .model-checkbox:hover {
            background: var(--gray-200);
            transform: translateY(-3px);
        }
        
        .model-checkbox input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }
        
        .checkbox-custom {
            position: relative;
            width: 22px;
            height: 22px;
            background: var(--white);
            border: 2px solid var(--primary-color);
            border-radius: 4px;
            margin-right: 10px;
            transition: all 0.2s ease;
        }
        
        .model-checkbox input:checked ~ .checkbox-custom {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .checkbox-custom:after {
            content: '';
            position: absolute;
            display: none;
            left: 7px;
            top: 3px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }
        
        .model-checkbox input:checked ~ .checkbox-custom:after {
            display: block;
        }
        
        .checkbox-label {
            font-weight: 500;
            color: var(--dark-color);
        }
        
        .compare-button {
            margin-top: 2rem;
        }
        
        .compare-loading {
            display: none;
        }
        
        .progress-container {
            width: 100%;
            max-width: 500px;
            height: 8px;
            background: var(--gray-200);
            border-radius: 10px;
            margin: 1.5rem auto;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        
        .progress-text {
            font-size: 1rem;
            color: var(--gray-400);
            margin-top: 1rem;
        }
        
        .current-model {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .compare-results {
            display: none;
            background: var(--panel-bg);
            border-radius: var(--panel-radius);
            box-shadow: var(--card-shadow);
            padding: 2.5rem;
            margin-top: 2.5rem;
            border: 1px solid var(--border-color);
            animation: fadeIn 0.8s ease-out;
        }
        
        .compare-results.active {
            display: block;
        }
        
        .compare-result-title {
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }
        
        .compare-prompt-display {
            text-align: center;
            color: var(--gray-400);
            font-style: italic;
            margin-bottom: 2.5rem;
            padding: 1rem;
            background: var(--gray-100);
            border-radius: 8px;
        }
        
        .compare-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2.5rem;
            margin-bottom: 2rem;
        }
        
        .compare-item {
            background: var(--white);
            border-radius: var(--panel-radius);
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border: 1px solid var(--gray-200);
            display: flex;
            flex-direction: column;
        }
        
        .compare-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.12);
        }
        
        .compare-item-header {
            padding: 1.2rem;
            background: var(--gray-100);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .compare-item-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.3rem;
        }
        
        .compare-item-subtitle {
            font-size: 0.9rem;
            color: var(--gray-400);
        }
        
        .compare-image-container {
            position: relative;
            padding-bottom: 100%;
            overflow: hidden;
        }
        
        .compare-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .compare-item:hover .compare-image {
            transform: scale(1.05);
        }
        
        .compare-actions {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .action-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem 2rem;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(124, 93, 250, 0.3);
        }
        
        .action-btn i {
            margin-right: 10px;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(124, 93, 250, 0.4);
        }
        
        .action-btn.save-comparison {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .action-btn.share-comparison {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }
        
        .dark-mode .model-checkbox {
            background: var(--gray-100);
        }
        
        .dark-mode .model-checkbox:hover {
            background: var(--gray-200);
        }
        
        .dark-mode .checkbox-custom {
            background: var(--panel-bg);
            border-color: var(--primary-light);
        }
        
        .dark-mode .checkbox-label {
            color: var(--text-color);
        }
        
        .dark-mode .compare-item {
            background: var(--panel-bg);
            border-color: var(--border-color);
        }
        
        .dark-mode .compare-item-header {
            background: var(--gray-100);
            border-color: var(--border-color);
        }
        
        .prompt-generator-intro {
            margin-bottom: 1.5rem;
            color: var(--gray-400);
            line-height: 1.6;
        }
        
        .generator-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .generator-form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .generator-form-group label {
            font-weight: 600;
            color: var(--dark-color);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .generator-select {
            padding: 1rem;
            border: 2px solid var(--gray-200);
            border-radius: 10px;
            background: var(--panel-bg);
            color: var(--text-color);
            font-size: 1rem;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg fill="%239ca3af" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
            background-repeat: no-repeat;
            background-position: right 1rem center;
        }
        
        .generator-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(124, 93, 250, 0.1);
        }
        
        .generate-prompt-btn {
            display: block;
            width: 100%;
            padding: 1.2rem;
            margin: 2rem 0;
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(124, 93, 250, 0.3);
        }
        
        .generate-prompt-btn i {
            margin-right: 8px;
        }
        
        .generate-prompt-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(124, 93, 250, 0.4);
        }
        
        .generator-results {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            display: none;
        }
        
        .generator-results.active {
            display: flex;
        }
        
        .generator-result-item {
            background: var(--gray-100);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            animation: fadeIn 0.5s ease-out;
        }
        
        .generator-result-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
        }
        
        .generator-result-text {
            color: var(--dark-color);
            line-height: 1.6;
            font-size: 1.05rem;
        }
        
        .generator-use-btn {
            align-self: flex-end;
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, var(--success-color), #5eead4);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(56, 190, 201, 0.2);
        }
        
        .generator-use-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(56, 190, 201, 0.3);
        }
        
        .generator-loading {
            text-align: center;
            margin: 3rem 0;
            display: none;
        }
        
        .generator-loading.active {
            display: block;
        }
        
        .spinner-small {
            width: 50px;
            height: 50px;
            border-width: 3px;
        }
        
        .dark-mode .generator-select {
            background-color: var(--panel-bg);
            border-color: var(--border-color);
            color: var(--text-color);
        }
        
        .dark-mode .generator-result-item {
            background: var(--gray-100);
        }
        
        .dark-mode .generator-result-text {
            color: var(--text-color);
        }

        .image-tools {
            position: absolute;
            bottom: 1.5rem;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 1.5rem;
            z-index: 5;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .result-image-container:hover .image-tools {
            opacity: 1;
            transform: translateY(0);
        }

        .image-tool-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-tool-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .download-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            margin-right: auto;
        }

        .share-btn {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            margin-left: auto;
        }

        .prompt-tools-dropdown {
            position: relative;
            margin-top: 1rem;
            z-index: 10;
        }

        .prompt-tools-main-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(124, 93, 250, 0.2);
            width: 100%;
        }

        .prompt-tools-main-btn i:first-child {
            margin-right: 8px;
            font-size: 1.1rem;
        }

        .prompt-tools-main-btn i:last-child {
            margin-left: 8px;
            font-size: 0.8rem;
            transition: transform 0.3s ease;
        }

        .prompt-tools-main-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(124, 93, 250, 0.3);
        }

        .prompt-tools-main-btn.active i:last-child {
            transform: rotate(180deg);
        }

        .prompt-tools-menu {
            position: absolute;
            top: calc(100% + 10px);
            left: 0;
            width: 100%;
            background: var(--panel-bg);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            padding: 0.8rem 0;
            display: none;
            flex-direction: column;
            z-index: 100;
            border: 1px solid var(--border-color);
            animation: fadeInScale 0.2s ease-out;
        }

        .prompt-tools-menu.visible {
            display: flex;
        }

        .prompt-tool-option {
            padding: 0.8rem 1.2rem;
            display: flex;
            align-items: center;
            color: var(--text-color);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .prompt-tool-option:hover {
            background: var(--gray-100);
            color: var(--primary-color);
        }

        .prompt-tool-option i {
            margin-right: 10px;
            font-size: 1.1rem;
            color: var(--primary-color);
            width: 20px;
            text-align: center;
        }

        .dark-mode .prompt-tools-menu {
            background: var(--panel-bg);
            border-color: var(--border-color);
        }

        .dark-mode .prompt-tool-option:hover {
            background: var(--gray-100);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- 装饰性流星元素 -->
        <div class="shooting-star"></div>
        <div class="shooting-star"></div>
        <div class="shooting-star"></div>
        
        <div class="header">
            <h1>AI画图生成器</h1>
            <p>释放你的创意，选择多种AI模型为你呈现艺术之美</p>
        </div>
        
        <div class="tabs" id="main-tabs">
            <button class="tab-btn active" data-tab="create"><i class="fas fa-magic"></i><span>创建图片</span></button>
            <button class="tab-btn" data-tab="gallery"><i class="fas fa-images"></i><span>历史画廊</span></button>
            <button class="tab-btn" data-tab="compare"><i class="fas fa-balance-scale"></i><span>模型比较</span></button>
        </div>
        
        <div class="tab-content active" id="create-tab">
            <div class="create-panel">
                <div class="form-group">
                    <label for="prompt"><i class="fas fa-pen"></i> 描述你想要的图片</label>
                    <textarea id="prompt" class="input-area" placeholder="例如：一位穿着华丽金色礼服的女王，坐在宫殿的王座上，周围有精美的装饰和盛开的花朵..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="model"><i class="fas fa-robot"></i> 选择AI模型</label>
                    <div class="model-selection-wrapper">
                        <select id="model">
                            <option value="grok-2-image-1212">Grok AI</option>
                            <option value="siliconflow">快手科技 Kolors</option>
                            <option value="flux">Flux.1-dev</option>
                            <option value="dall-e-3" selected>DALL-E 3</option>
                            <option value="flux-pro">Flux Pro</option>
                            <option value="stable-diffusion-3.5">Stable Diffusion 3.5</option>
                            <option value="stable-diffusion-xl">Stable Diffusion XL</option>
                        </select>
                        <button id="style-preview-btn" class="style-preview-btn" title="查看模型风格示例">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div id="grok-options-container" class="grok-options">
                    <div class="option-row">
                        <div class="option-col">
                            <label class="option-label" for="grok-image-count">生成图片数量</label>
                            <select class="option-select" id="grok-image-count">
                                <option value="1" selected>1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                            </select>
                        </div>
                    </div>
                    <p class="options-note">注：Grok AI 支持一次性生成1-10张图片，生成数量越多耗时越长</p>
                </div>
                
                <button class="grok-toggle" id="grok-toggle">
                    <i class="fas fa-chevron-down"></i> Grok 高级选项
                </button>
                
                <div id="advanced-options-container" class="advanced-options">
                    <div class="option-row">
                        <div class="option-col">
                            <label class="option-label" for="image-size">图像尺寸</label>
                            <select class="option-select" id="image-size">
                                <option value="1024x1024" selected>1024x1024</option>
                                <option value="960x1280">960x1280</option>
                                <option value="768x1024">768x1024</option>
                                <option value="720x1440">720x1440</option>
                                <option value="720x1280">720x1280</option>
                            </select>
                        </div>
                        <div class="option-col">
                            <label class="option-label" for="batch-size">生成数量</label>
                            <select class="option-select" id="batch-size">
                                <option value="1" selected>1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                        </div>
                    </div>
                    <div class="option-row">
                        <div class="option-col">
                            <label class="option-label" for="inference-steps">推理步数 (1-100)</label>
                            <input type="number" class="option-input" id="inference-steps" min="1" max="100" value="20">
                        </div>
                        <div class="option-col">
                            <label class="option-label" for="guidance-scale">引导比例 (0-20)</label>
                            <input type="number" class="option-input" id="guidance-scale" min="0" max="20" step="0.1" value="7.5">
                        </div>
                    </div>
                    <div class="option-row">
                        <div class="option-col">
                            <label class="option-label" for="negative-prompt">负面提示词</label>
                            <input type="text" class="option-input" id="negative-prompt" placeholder="输入不希望出现在图像中的元素">
                        </div>
                        <div class="option-col">
                            <label class="option-label" for="seed">随机种子 (可选)</label>
                            <input type="number" class="option-input" id="seed" min="0" max="9999999999" placeholder="留空使用随机种子">
                        </div>
                    </div>
                    <p class="options-note">注：更高的引导比例会使生成图像更严格地匹配提示词；更低的值会产生更具创意和多样性的图像。</p>
                </div>
                
                <button class="advanced-toggle" id="advanced-toggle">
                    <i class="fas fa-chevron-down"></i> Kolors 高级选项
                </button>
                
                <div id="boodlebox-options-container" class="advanced-options">
                    <div class="option-row">
                        <div class="option-col">
                            <label class="option-label" for="boodlebox-image-count">生成图片数量</label>
                            <select class="option-select" id="boodlebox-image-count">
                                <option value="1" selected>1</option>
                            </select>
                        </div>
                    </div>
                    <p class="options-note">注：BoodleBox API 目前仅支持一次生成1张图片</p>
                </div>
                
                <button class="advanced-toggle" id="boodlebox-toggle">
                    <i class="fas fa-chevron-down"></i> BoodleBox 高级选项
                </button>
                
                <!-- Flux模型参数选项 -->
                <div id="flux-options-container" class="advanced-options">
                    <div class="option-row">
                        <div class="option-col">
                            <label class="option-label" for="flux-width">图像宽度 (256-1024)</label>
                            <input type="number" class="option-input" id="flux-width" min="256" max="1024" step="8" value="512">
                        </div>
                        <div class="option-col">
                            <label class="option-label" for="flux-height">图像高度 (256-1024)</label>
                            <input type="number" class="option-input" id="flux-height" min="256" max="1024" step="8" value="512">
                        </div>
                    </div>
                    <div class="option-row">
                        <div class="option-col">
                            <label class="option-label" for="flux-steps">生成步数 (10-50)</label>
                            <input type="number" class="option-input" id="flux-steps" min="10" max="50" value="20">
                        </div>
                        <div class="option-col">
                            <label class="option-label" for="flux-batch-size">生成数量 (1-4)</label>
                            <select class="option-select" id="flux-batch-size">
                                <option value="1" selected>1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                        </div>
                    </div>
                    <div class="option-row">
                        <div class="option-col">
                            <label class="option-label" for="flux-seed">随机种子 (0-999999999)</label>
                            <input type="number" class="option-input" id="flux-seed" min="0" max="999999999" placeholder="留空使用随机种子">
                        </div>
                    </div>
                    <p class="options-note">注：Flux.1-dev 支持自定义宽高、生成步数和随机种子，以及批量生成多张图片。</p>
                </div>
                
                <button class="advanced-toggle" id="flux-toggle">
                    <i class="fas fa-chevron-down"></i> Flux 高级选项
                </button>
                
                <button id="generate" class="button"><i class="fas fa-paint-brush"></i> 生成图片</button>
            </div>
            
            <div class="loading">
                <div class="spinner"></div>
                <p>AI正在绘制您的创意，请稍候...</p>
            </div>
            
            <div class="error-message" id="error"></div>
            
            <div class="result-panel">
                <div class="revised-prompt" id="revised-prompt"></div>
                <div id="result-images-container" class="result-image-wrapper"></div>
            </div>
        </div>
        
        <div class="tab-content" id="gallery-tab">
            <div class="gallery-header">
                <h2>社区永久画廊</h2>
                <p>所有用户的创意作品将被永久保存在这里</p>
            </div>
            
            <!-- 搜索框 -->
            <div class="gallery-search">
                <i class="fas fa-search"></i>
                <input type="text" id="gallery-search-input" placeholder="搜索提示词...">
            </div>
            
            <!-- 筛选按钮 -->
            <div class="gallery-filters">
                <button class="filter-btn active" data-filter="all"><i class="fas fa-th-large"></i> 全部</button>
                <button class="filter-btn" data-filter="dall-e-3"><i class="fas fa-robot"></i> DALL-E 3</button>
                <button class="filter-btn" data-filter="grok-2-image-1212"><i class="fas fa-magic"></i> Grok AI</button>
                <button class="filter-btn" data-filter="siliconflow"><i class="fas fa-image"></i> 快手科技 Kolors</button>
                <button class="filter-btn" data-filter="flux"><i class="fas fa-paint-brush"></i> Flux</button>
                <button class="filter-btn" data-filter="stable-diffusion"><i class="fas fa-layer-group"></i> Stable Diffusion</button>
            </div>
            
            <div id="gallery" class="gallery">
                <!-- 历史画廊将在这里动态加载 -->
            </div>
            
            <!-- 无搜索结果显示 -->
            <div class="no-results" id="no-results" style="display: none;">
                <i class="fas fa-search"></i>
                <p>没有找到匹配的结果</p>
            </div>
            
            <div id="gallery-loading" class="loading">
                <div class="spinner"></div>
                <p>正在加载社区作品...</p>
            </div>
        </div>
        
        <div class="tab-content" id="compare-tab">
            <div class="compare-header">
                <h2>AI模型比较工具</h2>
                <p>使用相同的提示词比较不同AI模型的表现</p>
            </div>
            
            <div class="compare-panel">
                <div class="form-group">
                    <label for="compare-prompt"><i class="fas fa-pen"></i> 输入比较提示词</label>
                    <textarea id="compare-prompt" class="input-area" placeholder="输入想要比较的提示词，我们将使用多个模型生成图像进行对比..."></textarea>
                </div>
                
                <div class="compare-models">
                    <h3 class="compare-subtitle"><i class="fas fa-robot"></i> 选择要比较的模型</h3>
                    <div class="model-checkboxes">
                        <label class="model-checkbox">
                            <input type="checkbox" value="dall-e-3" checked>
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">DALL-E 3</span>
                        </label>
                        <label class="model-checkbox">
                            <input type="checkbox" value="grok-2-image-1212" checked>
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">Grok AI</span>
                        </label>
                        <label class="model-checkbox">
                            <input type="checkbox" value="siliconflow" checked>
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">快手科技 Kolors</span>
                        </label>
                        <label class="model-checkbox">
                            <input type="checkbox" value="flux">
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">Flux.1-dev</span>
                        </label>
                        <label class="model-checkbox">
                            <input type="checkbox" value="stable-diffusion-3.5">
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">Stable Diffusion 3.5</span>
                        </label>
                    </div>
                </div>
                
                <button id="start-compare" class="button compare-button">
                    <i class="fas fa-play-circle"></i> 开始比较
                </button>
            </div>
            
            <div class="loading compare-loading">
                <div class="spinner"></div>
                <p>正在多模型对比生成中，请稍候...</p>
                <div class="progress-container">
                    <div class="progress-bar"></div>
                </div>
                <p class="progress-text">正在生成 <span class="current-model">DALL-E 3</span> 图像 (1/3)</p>
            </div>
            
            <div class="compare-results">
                <h3 class="compare-result-title">比较结果</h3>
                <p class="compare-prompt-display"></p>
                
                <div class="compare-grid">
                    <!-- 比较结果将在这里动态加载 -->
                </div>
                
                <div class="compare-actions">
                    <button class="action-btn save-comparison">
                        <i class="fas fa-download"></i> 保存比较结果
                    </button>
                    <button class="action-btn share-comparison">
                        <i class="fas fa-share-alt"></i> 分享比较结果
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 模态框 -->
    <div class="modal" id="image-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">图片详情</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <img src="" class="modal-image" id="modal-image">
                <div class="modal-details">
                    <div class="modal-prompt" id="modal-prompt"></div>
                    <div class="modal-info">
                        <span id="modal-model"></span>
                        <span id="modal-time"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 深色模式切换按钮 -->
    <button class="theme-switch" id="theme-switch">
        <i class="fas fa-moon dark-mode-icon"></i>
        <i class="fas fa-sun light-mode-icon"></i>
    </button>
    
    <!-- 移动端底部导航 -->
    <div class="mobile-nav" id="mobile-nav" style="display: none;">
        <button class="mobile-nav-btn active" data-tab="create">
            <i class="fas fa-magic"></i>
            <span>创建</span>
        </button>
        <button class="mobile-nav-btn" data-tab="gallery">
            <i class="fas fa-images"></i>
            <span>画廊</span>
        </button>
        <button class="mobile-nav-btn" id="mobile-theme-switch">
            <i class="fas fa-moon dark-mode-icon"></i>
            <i class="fas fa-sun light-mode-icon"></i>
            <span>主题</span>
        </button>
    </div>

    <!-- 添加模型风格预览模态框 -->
    <div class="modal" id="style-preview-modal">
        <div class="modal-content style-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">AI模型风格预览</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="style-tabs">
                    <button class="style-tab active" data-model="dall-e-3">DALL-E 3</button>
                    <button class="style-tab" data-model="grok-2-image-1212">Grok AI</button>
                    <button class="style-tab" data-model="siliconflow">快手科技 Kolors</button>
                    <button class="style-tab" data-model="flux">Flux.1-dev</button>
                    <button class="style-tab" data-model="flux-pro">Flux Pro</button>
                    <button class="style-tab" data-model="stable-diffusion-3.5">SD 3.5</button>
                    <button class="style-tab" data-model="stable-diffusion-xl">SD XL</button>
                </div>
                <div class="style-content">
                    <div class="style-panel active" data-model="dall-e-3">
                        <div class="style-info">
                            <h4>DALL-E 3</h4>
                            <p>OpenAI的最新图像生成模型，擅长创建高度准确、细节丰富的图像，尤其适合复杂场景和写实风格。</p>
                        </div>
                        <div class="style-examples">
                            <img src="https://img.djxs.xyz/dalle3_example1.jpg" alt="DALL-E 3 风格示例1" class="style-example-img">
                            <img src="https://img.djxs.xyz/dalle3_example2.jpg" alt="DALL-E 3 风格示例2" class="style-example-img">
                        </div>
                    </div>
                    <div class="style-panel" data-model="grok-2-image-1212">
                        <div class="style-info">
                            <h4>Grok AI</h4>
                            <p>xAI开发的Grok图像生成模型，风格多样化，色彩丰富，适合创意性和艺术性较强的场景。</p>
                        </div>
                        <div class="style-examples">
                            <img src="https://img.djxs.xyz/grok_example1.jpg" alt="Grok AI 风格示例1" class="style-example-img">
                            <img src="https://img.djxs.xyz/grok_example2.jpg" alt="Grok AI 风格示例2" class="style-example-img">
                        </div>
                    </div>
                    <div class="style-panel" data-model="siliconflow">
                        <div class="style-info">
                            <h4>快手科技 Kolors</h4>
                            <p>快手科技推出的高质量图像生成模型，对中文提示词理解较好，适合东方元素和现代风格图像生成。</p>
                        </div>
                        <div class="style-examples">
                            <img src="https://img.djxs.xyz/kolors_example1.jpg" alt="Kolors 风格示例1" class="style-example-img">
                            <img src="https://img.djxs.xyz/kolors_example2.jpg" alt="Kolors 风格示例2" class="style-example-img">
                        </div>
                    </div>
                    <div class="style-panel" data-model="flux">
                        <div class="style-info">
                            <h4>Flux.1-dev</h4>
                            <p>Stability AI的实验性模型，风格灵活多变，特别适合艺术和创意类图像，支持多种尺寸和参数调整。</p>
                        </div>
                        <div class="style-examples">
                            <img src="https://img.djxs.xyz/flux_example1.jpg" alt="Flux 风格示例1" class="style-example-img">
                            <img src="https://img.djxs.xyz/flux_example2.jpg" alt="Flux 风格示例2" class="style-example-img">
                        </div>
                    </div>
                    <div class="style-panel" data-model="flux-pro">
                        <!-- 其他模型风格示例内容 -->
                        <div class="style-info">
                            <h4>Flux Pro</h4>
                            <p>Flux的专业版本，生成质量更高，细节和创意性更强，适合专业设计和艺术创作需求。</p>
                        </div>
                        <div class="style-examples">
                            <img src="https://img.djxs.xyz/fluxpro_example1.jpg" alt="Flux Pro 风格示例1" class="style-example-img">
                            <img src="https://img.djxs.xyz/fluxpro_example2.jpg" alt="Flux Pro 风格示例2" class="style-example-img">
                        </div>
                    </div>
                    <div class="style-panel" data-model="stable-diffusion-3.5">
                        <div class="style-info">
                            <h4>Stable Diffusion 3.5</h4>
                            <p>Stability AI的最新模型，渲染质量和细节表现大幅提升，对复杂提示词的理解能力强。</p>
                        </div>
                        <div class="style-examples">
                            <img src="https://img.djxs.xyz/sd35_example1.jpg" alt="SD 3.5 风格示例1" class="style-example-img">
                            <img src="https://img.djxs.xyz/sd35_example2.jpg" alt="SD 3.5 风格示例2" class="style-example-img">
                        </div>
                    </div>
                    <div class="style-panel" data-model="stable-diffusion-xl">
                        <div class="style-info">
                            <h4>Stable Diffusion XL</h4>
                            <p>专为高分辨率图像设计的稳定扩散模型，细节表现和画面质感出众，适合需要高质量图像输出的场景。</p>
                        </div>
                        <div class="style-examples">
                            <img src="https://img.djxs.xyz/sdxl_example1.jpg" alt="SD XL 风格示例1" class="style-example-img">
                            <img src="https://img.djxs.xyz/sdxl_example2.jpg" alt="SD XL 风格示例2" class="style-example-img">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加提示词优化助手模态框 -->
    <div class="modal" id="prompt-assistant-modal">
        <div class="modal-content prompt-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">提示词优化助手</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p class="prompt-assistant-intro">输入你的基本想法，我们将帮你优化提示词，创建更精美的图像。</p>
                
                <div class="assistant-sections">
                    <div class="assistant-section">
                        <h4 class="assistant-section-title"><i class="fas fa-paint-brush"></i> 艺术风格</h4>
                        <div class="assistant-chips">
                            <span class="assistant-chip" data-category="style" data-value="写实主义">写实主义</span>
                            <span class="assistant-chip" data-category="style" data-value="印象派">印象派</span>
                            <span class="assistant-chip" data-category="style" data-value="赛博朋克">赛博朋克</span>
                            <span class="assistant-chip" data-category="style" data-value="水彩画">水彩画</span>
                            <span class="assistant-chip" data-category="style" data-value="像素艺术">像素艺术</span>
                            <span class="assistant-chip" data-category="style" data-value="油画">油画</span>
                            <span class="assistant-chip" data-category="style" data-value="插画风格">插画风格</span>
                            <span class="assistant-chip" data-category="style" data-value="国风水墨">国风水墨</span>
                        </div>
                    </div>
                    
                    <div class="assistant-section">
                        <h4 class="assistant-section-title"><i class="fas fa-lightbulb"></i> 光照效果</h4>
                        <div class="assistant-chips">
                            <span class="assistant-chip" data-category="lighting" data-value="自然光">自然光</span>
                            <span class="assistant-chip" data-category="lighting" data-value="黄昏光线">黄昏光线</span>
                            <span class="assistant-chip" data-category="lighting" data-value="体积光">体积光</span>
                            <span class="assistant-chip" data-category="lighting" data-value="霓虹灯光">霓虹灯光</span>
                            <span class="assistant-chip" data-category="lighting" data-value="戏剧性光影">戏剧性光影</span>
                            <span class="assistant-chip" data-category="lighting" data-value="背光">背光</span>
                        </div>
                    </div>
                    
                    <div class="assistant-section">
                        <h4 class="assistant-section-title"><i class="fas fa-camera"></i> 相机设置</h4>
                        <div class="assistant-chips">
                            <span class="assistant-chip" data-category="camera" data-value="广角镜头">广角镜头</span>
                            <span class="assistant-chip" data-category="camera" data-value="长焦镜头">长焦镜头</span>
                            <span class="assistant-chip" data-category="camera" data-value="微距镜头">微距镜头</span>
                            <span class="assistant-chip" data-category="camera" data-value="浅景深">浅景深</span>
                            <span class="assistant-chip" data-category="camera" data-value="8K超高清">8K超高清</span>
                            <span class="assistant-chip" data-category="camera" data-value="电影级画质">电影级画质</span>
                        </div>
                    </div>
                    
                    <div class="assistant-section">
                        <h4 class="assistant-section-title"><i class="fas fa-palette"></i> 色彩倾向</h4>
                        <div class="assistant-chips">
                            <span class="assistant-chip" data-category="color" data-value="暖色调">暖色调</span>
                            <span class="assistant-chip" data-category="color" data-value="冷色调">冷色调</span>
                            <span class="assistant-chip" data-category="color" data-value="鲜艳对比色">鲜艳对比色</span>
                            <span class="assistant-chip" data-category="color" data-value="柔和色彩">柔和色彩</span>
                            <span class="assistant-chip" data-category="color" data-value="单色调">单色调</span>
                            <span class="assistant-chip" data-category="color" data-value="高对比度">高对比度</span>
                        </div>
                    </div>
                </div>
                
                <div class="assistant-preview">
                    <h4 class="assistant-preview-title">优化后的提示词</h4>
                    <div class="assistant-preview-content" id="optimized-prompt"></div>
                    <button id="apply-optimized-prompt" class="apply-prompt-btn" disabled>
                        <i class="fas fa-check"></i> 应用优化提示词
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加AI提示词生成模态框 -->
    <div class="modal" id="prompt-generator-modal">
        <div class="modal-content prompt-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">AI提示词生成器</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p class="prompt-generator-intro">选择你感兴趣的主题和风格，AI将为你生成创意提示词</p>
                
                <div class="generator-form">
                    <div class="generator-form-group">
                        <label for="generator-theme">主题</label>
                        <select id="generator-theme" class="generator-select">
                            <option value="nature">自然风景</option>
                            <option value="fantasy">奇幻世界</option>
                            <option value="scifi">科幻场景</option>
                            <option value="character">人物肖像</option>
                            <option value="animal">动物</option>
                            <option value="architecture">建筑</option>
                            <option value="abstract">抽象艺术</option>
                            <option value="oriental">东方元素</option>
                        </select>
                    </div>
                    
                    <div class="generator-form-group">
                        <label for="generator-style">艺术风格</label>
                        <select id="generator-style" class="generator-select">
                            <option value="realistic">写实主义</option>
                            <option value="impressionist">印象派</option>
                            <option value="cyberpunk">赛博朋克</option>
                            <option value="watercolor">水彩</option>
                            <option value="oilpainting">油画</option>
                            <option value="minimal">极简主义</option>
                            <option value="cartoon">卡通动漫</option>
                            <option value="ink">水墨国风</option>
                            <option value="digital">数字艺术</option>
                        </select>
                    </div>
                    
                    <div class="generator-form-group">
                        <label for="generator-mood">情绪氛围</label>
                        <select id="generator-mood" class="generator-select">
                            <option value="peaceful">平静</option>
                            <option value="dramatic">戏剧性</option>
                            <option value="mysterious">神秘</option>
                            <option value="happy">欢快</option>
                            <option value="melancholy">忧郁</option>
                            <option value="epic">史诗感</option>
                            <option value="dreamy">梦幻</option>
                            <option value="energetic">充满活力</option>
                        </select>
                    </div>
                    
                    <div class="generator-form-group">
                        <label for="generator-complexity">复杂度</label>
                        <select id="generator-complexity" class="generator-select">
                            <option value="simple">简单</option>
                            <option value="moderate">适中</option>
                            <option value="complex">复杂</option>
                            <option value="verycomplex">非常复杂</option>
                        </select>
                    </div>
                </div>
                
                <button id="generate-prompt-btn" class="generate-prompt-btn">
                    <i class="fas fa-sparkles"></i> 生成创意提示词
                </button>
                
                <div class="generator-results">
                    <div class="generator-result-item">
                        <div class="generator-result-text" id="generated-prompt-1"></div>
                        <button class="generator-use-btn" data-index="1">使用此提示词</button>
                    </div>
                    <div class="generator-result-item">
                        <div class="generator-result-text" id="generated-prompt-2"></div>
                        <button class="generator-use-btn" data-index="2">使用此提示词</button>
                    </div>
                    <div class="generator-result-item">
                        <div class="generator-result-text" id="generated-prompt-3"></div>
                        <button class="generator-use-btn" data-index="3">使用此提示词</button>
                    </div>
                </div>
                
                <div class="generator-loading">
                    <div class="spinner spinner-small"></div>
                    <p>AI正在创作提示词...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 元素获取
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            const mainTabs = document.getElementById('main-tabs');
            const generateBtn = document.getElementById('generate');
            const promptInput = document.getElementById('prompt');
            const modelSelect = document.getElementById('model');
            const resultPanel = document.querySelector('.result-panel');
            const resultImagesContainer = document.getElementById('result-images-container');
            const loadingDiv = document.querySelector('.loading');
            const errorDiv = document.getElementById('error');
            const revisedPromptDiv = document.getElementById('revised-prompt');
            const galleryDiv = document.getElementById('gallery');
            const galleryLoading = document.getElementById('gallery-loading');
            const modal = document.getElementById('image-modal');
            const modalClose = document.querySelector('.modal-close');
            const modalImage = document.getElementById('modal-image');
            const modalPrompt = document.getElementById('modal-prompt');
            const modalModel = document.getElementById('modal-model');
            const modalTime = document.getElementById('modal-time');
            
            // 高级选项相关元素
            const advancedToggle = document.getElementById('advanced-toggle');
            const advancedOptions = document.getElementById('advanced-options-container');
            const imageSizeSelect = document.getElementById('image-size');
            const batchSizeSelect = document.getElementById('batch-size');
            const inferenceStepsInput = document.getElementById('inference-steps');
            const guidanceScaleInput = document.getElementById('guidance-scale');
            const negativePromptInput = document.getElementById('negative-prompt');
            const seedInput = document.getElementById('seed');
            
            // Grok参数选项相关元素
            const grokToggle = document.getElementById('grok-toggle');
            const grokOptions = document.getElementById('grok-options-container');
            const grokImageCountSelect = document.getElementById('grok-image-count');
            
            // BoodleBox参数选项相关元素
            const boodleboxToggle = document.getElementById('boodlebox-toggle');
            const boodleboxOptions = document.getElementById('boodlebox-options-container');
            const boodleboxImageCountSelect = document.getElementById('boodlebox-image-count');
            
            // Flux参数选项相关元素
            const fluxToggle = document.getElementById('flux-toggle');
            const fluxOptions = document.getElementById('flux-options-container');
            const fluxWidthInput = document.getElementById('flux-width');
            const fluxHeightInput = document.getElementById('flux-height');
            const fluxStepsInput = document.getElementById('flux-steps');
            const fluxBatchSizeSelect = document.getElementById('flux-batch-size');
            const fluxSeedInput = document.getElementById('flux-seed');
            
            // API端点
            const API_ENDPOINTS = {
                GET_HISTORY: '/api/get_history.php',
                ADD_HISTORY: '/api/add_history.php',
                DELETE_HISTORY: '/api/delete_history.php',
                BOODLEBOX_GENERATE: '/api/boodlebox_generate.php',
                FLUX_GENERATE: '/api/flux_generate.php'
            };
            
            // 全局变量用于存储原始历史数据
            let originalHistory = [];
            
            // 渲染历史画廊
            function renderGallery(history) {
                if (!history || history.length === 0) {
                    galleryDiv.innerHTML = `
                        <div class="empty-gallery">
                            <i class="fas fa-image"></i>
                            <p>暂无社区作品，成为第一个创作者吧！</p>
                        </div>
                    `;
                    document.getElementById('no-results').style.display = 'none';
                    return;
                }
                
                // 保存原始数据用于筛选
                if (originalHistory.length === 0) {
                    originalHistory = [...history];
                }
                
                galleryDiv.innerHTML = '';
                history.forEach((item, index) => {
                    const date = new Date(item.timestamp);
                    const formattedDate = `${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                    
                    const galleryItem = document.createElement('div');
                    galleryItem.className = 'gallery-item';
                    galleryItem.setAttribute('data-model', item.model);
                    galleryItem.setAttribute('data-prompt', item.prompt.toLowerCase());
                    galleryItem.style.setProperty('--index', index);
                    galleryItem.innerHTML = `
                        <div class="gallery-image-container">
                            <div class="image-skeleton"></div>
                            <div class="image-loading-icon"><i class="fas fa-spinner fa-spin"></i></div>
                            <img src="${item.imageUrl}" class="gallery-image" alt="${item.prompt}" loading="lazy" onload="this.classList.add('loaded')">
                        </div>
                        <div class="gallery-content">
                            <span class="gallery-model">${getModelDisplayName(item.model)}</span>
                            <p class="gallery-prompt">${item.prompt}</p>
                            <span class="gallery-time">${formattedDate}</span>
                            <div class="gallery-actions">
                                <button class="gallery-btn view-btn" data-id="${item.id}">
                                    <i class="fas fa-eye"></i> 查看详情
                                </button>
                            </div>
                        </div>
                    `;
                    galleryDiv.appendChild(galleryItem);
                });
                
                // 显示或隐藏无结果提示
                document.getElementById('no-results').style.display = history.length === 0 ? 'block' : 'none';
                
                // 绑定筛选功能
                bindFilterButtons();
                
                // 绑定查看详情事件
                document.querySelectorAll('.view-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = this.getAttribute('data-id');
                        const item = history.find(item => item.id === id);
                        if (!item) return;
                        
                        modalImage.src = item.imageUrl;
                        modalPrompt.textContent = item.prompt;
                        if (item.revisedPrompt) {
                            modalPrompt.innerHTML = `原始提示词: ${item.prompt}<br><br>AI理解的提示词: ${item.revisedPrompt}`;
                        } else {
                            modalPrompt.textContent = item.prompt;
                        }
                        modalModel.textContent = `模型: ${getModelDisplayName(item.model)}`;
                        
                        const date = new Date(item.timestamp);
                        modalTime.textContent = `时间: ${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                        
                        modal.classList.add('active');
                    });
                });
            }
            
            // 绑定筛选按钮
            function bindFilterButtons() {
                // 获取筛选按钮
                const filterButtons = document.querySelectorAll('.filter-btn');
                const searchInput = document.getElementById('gallery-search-input');
                
                // 筛选按钮点击事件
                filterButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        // 移除所有按钮的活动状态
                        filterButtons.forEach(btn => btn.classList.remove('active'));
                        // 添加当前按钮的活动状态
                        this.classList.add('active');
                        
                        // 获取筛选值
                        const filterValue = this.getAttribute('data-filter');
                        
                        // 筛选画廊项目
                        filterGallery(filterValue, searchInput.value.trim().toLowerCase());
                    });
                });
                
                // 搜索输入事件
                searchInput.addEventListener('input', function() {
                    const activeFilter = document.querySelector('.filter-btn.active');
                    const filterValue = activeFilter.getAttribute('data-filter');
                    
                    // 应用搜索和筛选
                    filterGallery(filterValue, this.value.trim().toLowerCase());
                });
            }
            
            // 筛选画廊项目
            function filterGallery(filterModel, searchText) {
                // 没有原始数据时不进行操作
                if (originalHistory.length === 0) return;
                
                // 应用模型筛选
                let filteredHistory = [...originalHistory];
                if (filterModel !== 'all') {
                    if (filterModel === 'stable-diffusion') {
                        // 特殊处理：稳定扩散类别包括多个型号
                        filteredHistory = filteredHistory.filter(item => 
                            item.model.includes('stable-diffusion'));
                    } else {
                        filteredHistory = filteredHistory.filter(item => item.model === filterModel);
                    }
                }
                
                // 应用搜索文本筛选
                if (searchText) {
                    filteredHistory = filteredHistory.filter(item => 
                        item.prompt.toLowerCase().includes(searchText));
                }
                
                // 使用筛选后的数据重新渲染画廊
                renderFilteredGallery(filteredHistory);
            }
            
            // 使用筛选后的数据渲染画廊
            function renderFilteredGallery(filteredHistory) {
                // 显示或隐藏无结果提示
                document.getElementById('no-results').style.display = 
                    filteredHistory.length === 0 ? 'block' : 'none';
                
                // 画廊为空时不渲染
                if (filteredHistory.length === 0) {
                    galleryDiv.innerHTML = '';
                    return;
                }
                
                // 重新渲染画廊，但保持绑定事件
                renderGallery(filteredHistory);
            }
            
            // 获取模型显示名称
            function getModelDisplayName(modelId) {
                const modelMap = {
                    'grok-2-image-1212': 'Grok AI',
                    'siliconflow': '快手科技 Kolors',
                    'flux': 'Flux.1-dev',
                    'dall-e-3': 'DALL-E 3',
                    'flux-pro': 'Flux Pro',
                    'stable-diffusion-3.5': 'Stable Diffusion 3.5',
                    'stable-diffusion-xl': 'Stable Diffusion XL'
                };
                return modelMap[modelId] || modelId;
            }
            
            // 标签切换
            tabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const tab = this.getAttribute('data-tab');
                    
                    tabBtns.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(`${tab}-tab`).classList.add('active');
                    
                    // 更新标签栏状态
                    mainTabs.classList.remove('gallery-active', 'compare-active');
                    if (tab === 'gallery') {
                        mainTabs.classList.add('gallery-active');
                        fetchHistory();
                    } else if (tab === 'compare') {
                        mainTabs.classList.add('compare-active');
                    }
                });
            });
            
            // 关闭模态框
            modalClose.addEventListener('click', function() {
                modal.classList.remove('active');
            });
            
            // 点击模态框外部关闭
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
            
            // ESC键关闭模态框
            document.addEventListener('keydown', function(e) {
                if (e.key === "Escape" && modal.classList.contains('active')) {
                    modal.classList.remove('active');
                }
            });
            
            // 生成图片
            generateBtn.addEventListener('click', generateImage);
            
            // 回车键也可以生成图片
            promptInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && e.ctrlKey) {
                    generateImage();
                }
            });
            
            // 下载图片
            function downloadImage(url, index) {
                const link = document.createElement('a');
                // 检查URL是否是base64数据
                if (url.startsWith('data:image')) {
                    // 已经是base64数据，直接使用
                    link.href = url;
                } else {
                    // 常规URL
                    link.href = url;
                }
                link.download = 'ai-art-' + Date.now() + '-' + index + '.png';
                link.click();
            }
            
            // 高级选项切换
            advancedToggle.addEventListener('click', function() {
                advancedToggle.classList.toggle('active');
                advancedOptions.classList.toggle('active');
            });
            
            // Grok参数选项切换
            grokToggle.addEventListener('click', function() {
                grokToggle.classList.toggle('active');
                grokOptions.classList.toggle('active');
            });
            
            // BoodleBox参数选项切换
            boodleboxToggle.addEventListener('click', function() {
                boodleboxToggle.classList.toggle('active');
                boodleboxOptions.classList.toggle('active');
            });
            
            // Flux参数选项切换
            fluxToggle.addEventListener('click', function() {
                fluxToggle.classList.toggle('active');
                fluxOptions.classList.toggle('active');
            });
            
            // 模型选择变化时处理选项面板的显示/隐藏
            modelSelect.addEventListener('change', function() {
                // 隐藏所有选项面板
                grokToggle.style.display = 'none';
                grokOptions.classList.remove('active');
                grokToggle.classList.remove('active');
                
                advancedToggle.style.display = 'none';
                advancedOptions.classList.remove('active');
                advancedToggle.classList.remove('active');
                
                boodleboxToggle.style.display = 'none';
                boodleboxOptions.classList.remove('active');
                boodleboxToggle.classList.remove('active');
                
                fluxToggle.style.display = 'none';
                fluxOptions.classList.remove('active');
                fluxToggle.classList.remove('active');
                
                // 根据选择的模型显示对应的选项
                if (modelSelect.value === 'grok-2-image-1212') {
                    grokToggle.style.display = 'flex';
                } else if (modelSelect.value === 'siliconflow') {
                    advancedToggle.style.display = 'flex';
                } else if (modelSelect.value === 'flux') {
                    fluxToggle.style.display = 'flex';
                } else if (['dall-e-3', 'flux-pro', 'stable-diffusion-3.5', 'stable-diffusion-xl'].includes(modelSelect.value)) {
                    boodleboxToggle.style.display = 'flex';
                }
            });
            
            // 初始化显示状态
            // 隐藏所有选项面板
            grokToggle.style.display = 'none';
            advancedToggle.style.display = 'none';
            boodleboxToggle.style.display = 'none';
            fluxToggle.style.display = 'none';
            
            // 根据初始选择的模型显示对应的选项
            if (modelSelect.value === 'grok-2-image-1212') {
                grokToggle.style.display = 'flex';
            } else if (modelSelect.value === 'siliconflow') {
                advancedToggle.style.display = 'flex';
            } else if (modelSelect.value === 'flux') {
                fluxToggle.style.display = 'flex';
            } else if (['dall-e-3', 'flux-pro', 'stable-diffusion-3.5', 'stable-diffusion-xl'].includes(modelSelect.value)) {
                boodleboxToggle.style.display = 'flex';
            }
            
            // 给输入框添加焦点事件
            promptInput.addEventListener('focus', function() {
                this.parentElement.classList.add('focus');
            });
            
            promptInput.addEventListener('blur', function() {
                this.parentElement.classList.remove('focus');
            });
            
            // 给所有输入框和选择框添加焦点事件
            const allInputs = document.querySelectorAll('textarea, select, input');
            
            allInputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.closest('.form-group').classList.add('focus');
                });
                
                input.addEventListener('blur', function() {
                    this.closest('.form-group').classList.remove('focus');
                });
            });
            
            // 给按钮添加涟漪效果
            document.querySelectorAll('.button').forEach(button => {
                button.addEventListener('click', function(e) {
                    const x = e.clientX - e.target.getBoundingClientRect().left;
                    const y = e.clientY - e.target.getBoundingClientRect().top;
                    
                    const ripple = document.createElement('span');
                    ripple.classList.add('ripple-effect');
                    ripple.style.left = `${x}px`;
                    ripple.style.top = `${y}px`;
                    
                    this.appendChild(ripple);
                    
                    setTimeout(() => {
                        ripple.remove();
                    }, 600);
                });
            });
            
            // 在页面加载时添加动画效果
            window.addEventListener('DOMContentLoaded', () => {
                document.body.classList.add('loaded');
            });
            
            async function generateImage() {
                const prompt = promptInput.value.trim();
                if (!prompt) {
                    showError('请输入图片描述');
                    return;
                }
                
                const model = modelSelect.value;
                
                // 显示加载状态
                generateBtn.disabled = true;
                loadingDiv.style.display = 'block';
                errorDiv.style.display = 'none';
                resultPanel.style.display = 'none';
                revisedPromptDiv.style.display = 'none';
                resultImagesContainer.innerHTML = '';
                
                try {
                    let response;
                    let data;
                    
                    // 根据选择的模型选择不同的API
                    if (model === 'grok-2-image-1212') {
                        // 使用Grok API
                        response = await fetch('/api/grok_generate.php', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                prompt: prompt,
                                n: grokOptions.classList.contains('active') ? parseInt(grokImageCountSelect.value) : 1
                            })
                        });
                        
                        if (!response.ok) {
                            throw new Error(`Grok API请求失败: ${response.status}`);
                        }
                    } else if (model === 'siliconflow') {
                        // 使用Silicon Flow API，包含高级选项
                        const requestData = {
                            prompt: prompt
                        };
                        
                        // 添加高级选项参数
                        if (advancedOptions.classList.contains('active')) {
                            requestData.image_size = imageSizeSelect.value;
                            requestData.batch_size = parseInt(batchSizeSelect.value);
                            requestData.num_inference_steps = parseInt(inferenceStepsInput.value);
                            requestData.guidance_scale = parseFloat(guidanceScaleInput.value);
                            
                            if (negativePromptInput.value.trim()) {
                                requestData.negative_prompt = negativePromptInput.value.trim();
                            }
                            
                            if (seedInput.value.trim()) {
                                requestData.seed = parseInt(seedInput.value.trim());
                            }
                        }
                        
                        response = await fetch('/api/siliconflow_generate.php', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(requestData)
                        });
                        
                        if (!response.ok) {
                            throw new Error(`快手科技 Kolors API请求失败: ${response.status}`);
                        }
                    } else if (model === 'flux') {
                        // 使用Flux API，包含高级选项
                        const requestData = {
                            prompt: prompt
                        };
                        
                        // 添加高级选项参数
                        if (fluxOptions.classList.contains('active')) {
                            requestData.width = parseInt(fluxWidthInput.value);
                            requestData.height = parseInt(fluxHeightInput.value);
                            requestData.batch_size = parseInt(fluxBatchSizeSelect.value);
                            requestData.steps = parseInt(fluxStepsInput.value);
                            
                            if (fluxSeedInput.value.trim()) {
                                requestData.seed = parseInt(fluxSeedInput.value.trim());
                            }
                        }
                        
                        response = await fetch(API_ENDPOINTS.FLUX_GENERATE, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(requestData)
                        });
                        
                        if (!response.ok) {
                            throw new Error(`Flux API请求失败: ${response.status}`);
                        }
                    } else if (['dall-e-3', 'flux-pro', 'stable-diffusion-3.5', 'stable-diffusion-xl'].includes(model)) {
                        // 使用BoodleBox API
                        response = await fetch(API_ENDPOINTS.BOODLEBOX_GENERATE, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                prompt: prompt,
                                n: 1,
                                model: model,
                                save_history: true
                            })
                        });
                        
                        if (!response.ok) {
                            throw new Error(`BoodleBox API请求失败: ${response.status}`);
                        }
                    } else {
                        throw new Error('未知的模型类型');
                    }
                    
                    data = await response.json();
                    
                    if (data.data && data.data.length > 0) {
                        // 清空之前的结果
                        resultImagesContainer.innerHTML = '';
                        
                        // 遍历所有生成的图片
                        data.data.forEach((item, index) => {
                            // 创建图片容器
                            const imageContainer = document.createElement('div');
                            imageContainer.className = 'result-image-container';
                            imageContainer.style.setProperty('--delay', index);
                            
                            // 创建骨架屏
                            const skeleton = document.createElement('div');
                            skeleton.className = 'image-skeleton';
                            
                            // 创建加载图标
                            const loadingIcon = document.createElement('div');
                            loadingIcon.className = 'image-loading-icon';
                            loadingIcon.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                            
                            // 创建图片元素
                            const img = document.createElement('img');
                            img.className = 'result-image';
                            img.alt = `生成的图片 ${index+1}`;
                            img.loading = 'lazy'; // 原生懒加载
                            
                            // 图片加载完成事件
                            img.onload = function() {
                                img.classList.add('loaded');
                                // 添加淡入效果
                                setTimeout(() => {
                                    skeleton.style.opacity = '0';
                                    loadingIcon.style.opacity = '0';
                                }, 300);
                            };
                            
                            // 设置图片源
                            img.src = item.url;
                            
                            // 创建图片操作工具栏
                            const imageTools = document.createElement('div');
                            imageTools.className = 'image-tools';
                            
                            // 创建下载按钮
                            const downloadButton = document.createElement('button');
                            downloadButton.className = 'image-tool-btn download-btn';
                            downloadButton.innerHTML = '<i class="fas fa-download"></i>';
                            downloadButton.title = '下载图片';
                            downloadButton.addEventListener('click', function(e) {
                                e.stopPropagation();
                                downloadImage(item.url, index+1);
                            });
                            
                            // 创建分享按钮
                            const shareButton = document.createElement('button');
                            shareButton.className = 'image-tool-btn share-btn';
                            shareButton.innerHTML = '<i class="fas fa-share-alt"></i>';
                            shareButton.title = '分享图片';
                            shareButton.addEventListener('click', function(e) {
                                e.stopPropagation();
                                showShareOptions(item.url, imageContainer);
                            });
                            
                            // 将按钮添加到工具栏
                            imageTools.appendChild(shareButton);
                            imageTools.appendChild(downloadButton);
                            
                            // 将元素添加到容器
                            imageContainer.appendChild(img);
                            imageContainer.appendChild(skeleton);
                            imageContainer.appendChild(loadingIcon);
                            imageContainer.appendChild(imageTools);
                            resultImagesContainer.appendChild(imageContainer);
                        });
                        
                        resultPanel.style.display = 'block';
                        
                        // 显示提示词
                        revisedPromptDiv.innerHTML = `<strong>提示词:</strong> "${prompt}"`;
                        revisedPromptDiv.style.display = 'block';
                        
                        // 只有当没有no_history标记时，才添加到历史记录
                        if (!data.no_history) {
                            // 只添加第一张图片到历史记录
                            await addToHistory(data);
                        }
                    } else {
                        throw new Error('未能获取图片URL');
                    }
                } catch (error) {
                    showError(`生成图片失败: ${error.message}`);
                } finally {
                    generateBtn.disabled = false;
                    loadingDiv.style.display = 'none';
                }
            }
            
            function showError(message) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
                errorDiv.scrollIntoView({ behavior: 'smooth' });
                
                // 错误消息显示3秒后自动隐藏
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 5000);
            }
            
            // 初始化
            if (document.querySelector('.tab-btn.active').getAttribute('data-tab') === 'gallery') {
                mainTabs.classList.add('gallery-active');
                fetchHistory();
            }
            
            // 深色模式切换功能
            const themeSwitch = document.getElementById('theme-switch');
            
            // 检查本地存储中的主题偏好
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
            }
            
            themeSwitch.addEventListener('click', () => {
                // 切换深色模式类
                document.body.classList.toggle('dark-mode');
                
                // 更新本地存储中的主题偏好
                if (document.body.classList.contains('dark-mode')) {
                    localStorage.setItem('darkMode', 'enabled');
                } else {
                    localStorage.setItem('darkMode', 'disabled');
                }
            });
            
            // 检测系统颜色模式
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
            
            // 如果用户没有明确设置主题，则使用系统首选项
            if (!localStorage.getItem('darkMode')) {
                if (prefersDarkScheme.matches) {
                    document.body.classList.add('dark-mode');
                }
            }
            
            // 监听系统颜色模式变化
            prefersDarkScheme.addEventListener('change', (e) => {
                // 仅当用户没有明确设置主题时应用系统首选项
                if (!localStorage.getItem('darkMode')) {
                    if (e.matches) {
                        document.body.classList.add('dark-mode');
                    } else {
                        document.body.classList.remove('dark-mode');
                    }
                }
            });
            
            // 获取历史记录
            async function fetchHistory() {
                galleryLoading.style.display = 'block';
                try {
                    const response = await fetch(API_ENDPOINTS.GET_HISTORY);
                    if (!response.ok) {
                        throw new Error('获取历史记录失败');
                    }
                    const history = await response.json();
                    renderGallery(history);
                } catch (error) {
                    console.error('获取历史记录出错:', error);
                    galleryDiv.innerHTML = `
                        <div class="empty-gallery">
                            <i class="fas fa-exclamation-circle"></i>
                            <p>获取社区画廊失败，请稍后再试。</p>
                        </div>
                    `;
                } finally {
                    galleryLoading.style.display = 'none';
                }
            }
            
            // 添加历史记录
            async function addToHistory(data) {
                try {
                    // 只取第一张图片添加到历史记录
                    const historyItem = {
                        prompt: promptInput.value.trim(),
                        model: modelSelect.value,
                        imageUrl: data.data[0].url,
                        revisedPrompt: data.data[0].revised_prompt || ''
                    };
                    
                    const response = await fetch(API_ENDPOINTS.ADD_HISTORY, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(historyItem)
                    });
                    
                    if (!response.ok) {
                        console.error('添加历史记录失败');
                    }
                } catch (error) {
                    console.error('添加历史记录出错:', error);
                }
            }
            
            // 删除历史记录
            async function deleteHistoryItem(id) {
                try {
                    const response = await fetch(API_ENDPOINTS.DELETE_HISTORY, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ id })
                    });
                    
                    if (!response.ok) {
                        throw new Error('删除记录失败');
                    }
                    
                    return await response.json();
                } catch (error) {
                    console.error('删除历史记录出错:', error);
                    return { success: false };
                }
            }
            
            // 监听系统颜色模式变化
            prefersDarkScheme.addEventListener('change', (e) => {
                // 仅当用户没有明确设置主题时应用系统首选项
                if (!localStorage.getItem('darkMode')) {
                    if (e.matches) {
                        document.body.classList.add('dark-mode');
                    } else {
                        document.body.classList.remove('dark-mode');
                    }
                }
            });
            
            // 移动端导航逻辑
            const mobileNav = document.getElementById('mobile-nav');
            const mobileThemeSwitch = document.getElementById('mobile-theme-switch');
            const mobileNavBtns = document.querySelectorAll('.mobile-nav-btn[data-tab]');
            
            // 根据设备尺寸显示或隐藏移动导航
            function checkMobileNav() {
                if (window.innerWidth <= 768) {
                    mobileNav.style.display = 'flex';
                    themeSwitch.style.display = 'none'; // 在移动端隐藏浮动按钮
                } else {
                    mobileNav.style.display = 'none';
                    themeSwitch.style.display = 'flex';
                }
            }
            
            // 初始检查
            checkMobileNav();
            
            // 窗口大小变化时检查
            window.addEventListener('resize', checkMobileNav);
            
            // 移动端深色模式切换
            mobileThemeSwitch.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                
                if (document.body.classList.contains('dark-mode')) {
                    localStorage.setItem('darkMode', 'enabled');
                } else {
                    localStorage.setItem('darkMode', 'disabled');
                }
            });
            
            // 移动端标签切换
            mobileNavBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const tab = this.getAttribute('data-tab');
                    
                    // 移除所有按钮和标签的活动状态
                    mobileNavBtns.forEach(b => b.classList.remove('active'));
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // 设置活动状态
                    this.classList.add('active');
                    document.querySelector(`.tab-btn[data-tab="${tab}"]`).classList.add('active');
                    document.getElementById(`${tab}-tab`).classList.add('active');
                    
                    // 更新标签栏状态
                    if (tab === 'gallery') {
                        mainTabs.classList.add('gallery-active');
                        fetchHistory();
                    } else {
                        mainTabs.classList.remove('gallery-active');
                    }
                });
            });
            
            // 添加提示词推荐功能
            const suggestionTags = document.querySelectorAll('.suggestion-tag');
            
            suggestionTags.forEach(tag => {
                tag.addEventListener('click', function() {
                    const promptText = this.getAttribute('data-prompt');
                    promptInput.value = promptText;
                    promptInput.focus();
                    // 显示提示词已选中的视觉反馈
                    this.classList.add('selected');
                    setTimeout(() => {
                        this.classList.remove('selected');
                    }, 1000);
                });
            });
            
            // 样式预览模态框
            const stylePreviewBtn = document.getElementById('style-preview-btn');
            const stylePreviewModal = document.getElementById('style-preview-modal');
            const styleTabs = document.querySelectorAll('.style-tab');
            const stylePanels = document.querySelectorAll('.style-panel');
            
            stylePreviewBtn.addEventListener('click', function() {
                stylePreviewModal.classList.add('active');
            });
            
            // 关闭风格预览模态框
            stylePreviewModal.querySelector('.modal-close').addEventListener('click', function() {
                stylePreviewModal.classList.remove('active');
            });
            
            // 点击模态框外部关闭
            stylePreviewModal.addEventListener('click', function(e) {
                if (e.target === stylePreviewModal) {
                    stylePreviewModal.classList.remove('active');
                }
            });
            
            // 风格标签切换
            styleTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const model = this.getAttribute('data-model');
                    
                    styleTabs.forEach(t => t.classList.remove('active'));
                    stylePanels.forEach(p => p.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.querySelector(`.style-panel[data-model="${model}"]`).classList.add('active');
                });
            });
            
            // 分享选项处理
            function showShareOptions(imageUrl, container) {
                // 移除所有已有的分享选项容器
                document.querySelectorAll('.share-options').forEach(el => el.remove());
                
                // 创建分享选项容器
                const shareOptions = document.createElement('div');
                shareOptions.className = 'share-options';
                
                // 微信分享
                const wechatOption = document.createElement('a');
                wechatOption.className = 'share-option wechat';
                wechatOption.innerHTML = '<i class="fab fa-weixin"></i> 分享到微信';
                wechatOption.href = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(imageUrl)}`;
                wechatOption.target = '_blank';
                
                // 微博分享
                const weiboOption = document.createElement('a');
                weiboOption.className = 'share-option weibo';
                weiboOption.innerHTML = '<i class="fab fa-weibo"></i> 分享到微博';
                weiboOption.href = `https://service.weibo.com/share/share.php?url=${encodeURIComponent(imageUrl)}&title=${encodeURIComponent('我用AI画图生成器创作了这张图片')}`;
                weiboOption.target = '_blank';
                
                // QQ分享
                const qqOption = document.createElement('a');
                qqOption.className = 'share-option qq';
                qqOption.innerHTML = '<i class="fab fa-qq"></i> 分享到QQ空间';
                qqOption.href = `https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=${encodeURIComponent(imageUrl)}&title=${encodeURIComponent('AI画图生成器')}&summary=${encodeURIComponent('我用AI画图生成器创作了这张图片')}`;
                qqOption.target = '_blank';
                
                // 复制链接
                const copyOption = document.createElement('div');
                copyOption.className = 'share-option copy';
                copyOption.innerHTML = '<i class="fas fa-copy"></i> 复制图片链接';
                copyOption.addEventListener('click', function() {
                    navigator.clipboard.writeText(imageUrl).then(() => {
                        showCopySuccess();
                    });
                });
                
                // 添加所有选项
                shareOptions.appendChild(wechatOption);
                shareOptions.appendChild(weiboOption);
                shareOptions.appendChild(qqOption);
                shareOptions.appendChild(copyOption);
                
                // 添加到容器
                container.appendChild(shareOptions);
                
                // 显示选项
                setTimeout(() => {
                    shareOptions.classList.add('active');
                }, 10);
                
                // 点击其他地方关闭分享选项
                document.addEventListener('click', closeShareOptions);
            }
            
            function closeShareOptions(e) {
                if (!e.target.closest('.share-btn') && !e.target.closest('.share-options')) {
                    document.querySelectorAll('.share-options').forEach(el => {
                        el.classList.remove('active');
                        setTimeout(() => {
                            el.remove();
                        }, 300);
                    });
                    document.removeEventListener('click', closeShareOptions);
                }
            }
            
            // 显示复制成功提示
            function showCopySuccess() {
                // 移除现有提示
                document.querySelectorAll('.copy-success').forEach(el => el.remove());
                
                // 创建新提示
                const copySuccess = document.createElement('div');
                copySuccess.className = 'copy-success';
                copySuccess.innerHTML = '链接已复制到剪贴板！';
                document.body.appendChild(copySuccess);
                
                // 显示提示
                setTimeout(() => {
                    copySuccess.classList.add('active');
                }, 10);
                
                // 自动消失
                setTimeout(() => {
                    copySuccess.classList.remove('active');
                    setTimeout(() => {
                        copySuccess.remove();
                    }, 500);
                }, 2000);
            }
            
            // 提示词优化助手
            const promptAssistantBtn = document.getElementById('prompt-assistant-btn');
            const promptAssistantModal = document.getElementById('prompt-assistant-modal');
            const optimizedPromptDiv = document.getElementById('optimized-prompt');
            const applyOptimizedPromptBtn = document.getElementById('apply-optimized-prompt');
            const assistantChips = document.querySelectorAll('.assistant-chip');
            
            // 打开提示词优化助手
            promptAssistantBtn.addEventListener('click', function() {
                // 重置选中状态
                assistantChips.forEach(chip => chip.classList.remove('selected'));
                
                // 更新预览
                updateOptimizedPrompt();
                
                // 打开模态框
                promptAssistantModal.classList.add('active');
            });
            
            // 关闭提示词优化助手模态框
            promptAssistantModal.querySelector('.modal-close').addEventListener('click', function() {
                promptAssistantModal.classList.remove('active');
            });
            
            // 点击模态框外部关闭
            promptAssistantModal.addEventListener('click', function(e) {
                if (e.target === promptAssistantModal) {
                    promptAssistantModal.classList.remove('active');
                }
            });
            
            // 点击提示词选项
            assistantChips.forEach(chip => {
                chip.addEventListener('click', function() {
                    // 切换选中状态
                    this.classList.toggle('selected');
                    
                    // 更新优化后的提示词
                    updateOptimizedPrompt();
                });
            });
            
            // 应用优化后的提示词
            applyOptimizedPromptBtn.addEventListener('click', function() {
                if (optimizedPromptDiv.textContent) {
                    promptInput.value = optimizedPromptDiv.textContent;
                    promptAssistantModal.classList.remove('active');
                    promptInput.focus();
                }
            });
            
            // 更新优化后的提示词
            function updateOptimizedPrompt() {
                const basePrompt = promptInput.value.trim();
                let optimizedPrompt = basePrompt;
                
                // 收集选中的提示词增强选项
                const selectedOptions = {
                    style: [],
                    lighting: [],
                    camera: [],
                    color: []
                };
                
                // 收集所有选中的选项
                document.querySelectorAll('.assistant-chip.selected').forEach(chip => {
                    const category = chip.getAttribute('data-category');
                    const value = chip.getAttribute('data-value');
                    if (category && value) {
                        selectedOptions[category].push(value);
                    }
                });
                
                // 只有当有基本提示词且选择了优化选项时才优化
                if (basePrompt && (
                    selectedOptions.style.length > 0 || 
                    selectedOptions.lighting.length > 0 || 
                    selectedOptions.camera.length > 0 || 
                    selectedOptions.color.length > 0
                )) {
                    // 构建优化的提示词
                    optimizedPrompt = basePrompt;
                    
                    // 添加风格
                    if (selectedOptions.style.length > 0) {
                        optimizedPrompt += '，' + selectedOptions.style.join('和') + '风格';
                    }
                    
                    // 添加光照
                    if (selectedOptions.lighting.length > 0) {
                        optimizedPrompt += '，' + selectedOptions.lighting.join('和');
                    }
                    
                    // 添加相机设置
                    if (selectedOptions.camera.length > 0) {
                        optimizedPrompt += '，' + selectedOptions.camera.join('，');
                    }
                    
                    // 添加色彩
                    if (selectedOptions.color.length > 0) {
                        optimizedPrompt += '，' + selectedOptions.color.join('，');
                    }
                    
                    applyOptimizedPromptBtn.disabled = false;
                } else {
                    if (!basePrompt) {
                        optimizedPrompt = '请先在提示词输入框中输入基本描述';
                    } else {
                        optimizedPrompt = basePrompt + '（选择左侧选项来优化提示词）';
                    }
                    applyOptimizedPromptBtn.disabled = true;
                }
                
                optimizedPromptDiv.textContent = optimizedPrompt;
            }
            
            // 监听提示词输入框的变化，以便更新优化助手
            promptInput.addEventListener('input', function() {
                if (promptAssistantModal.classList.contains('active')) {
                    updateOptimizedPrompt();
                }
            });
            
            // 模型比较功能
            const comparePromptInput = document.getElementById('compare-prompt');
            const startCompareBtn = document.getElementById('start-compare');
            const compareLoading = document.querySelector('.compare-loading');
            const compareResults = document.querySelector('.compare-results');
            const compareGrid = document.querySelector('.compare-grid');
            const progressBar = document.querySelector('.progress-bar');
            const progressText = document.querySelector('.progress-text');
            const currentModelSpan = document.querySelector('.current-model');
            const comparePromptDisplay = document.querySelector('.compare-prompt-display');
            
            startCompareBtn.addEventListener('click', async function() {
                // 获取提示词
                const prompt = comparePromptInput.value.trim();
                if (!prompt) {
                    showError('请输入比较提示词');
                    return;
                }
                
                // 获取选中的模型
                const selectedModels = [];
                document.querySelectorAll('.model-checkbox input:checked').forEach(checkbox => {
                    selectedModels.push(checkbox.value);
                });
                
                if (selectedModels.length === 0) {
                    showError('请至少选择一个模型进行比较');
                    return;
                }
                
                // 显示加载状态
                startCompareBtn.disabled = true;
                compareLoading.style.display = 'block';
                compareResults.classList.remove('active');
                compareGrid.innerHTML = '';
                
                try {
                    // 初始化进度条
                    let progress = 0;
                    const progressStep = 100 / selectedModels.length;
                    progressBar.style.width = '0%';
                    
                    // 存储所有比较结果
                    const compareItems = [];
                    
                    // 为每个选中的模型生成图像
                    for (let i = 0; i < selectedModels.length; i++) {
                        const model = selectedModels[i];
                        
                        // 更新进度条和文本
                        currentModelSpan.textContent = getModelDisplayName(model);
                        progressText.innerHTML = `正在生成 <span class="current-model">${getModelDisplayName(model)}</span> 图像 (${i+1}/${selectedModels.length})`;
                        
                        try {
                            // 使用相同的API调用逻辑，但根据模型调整
                            let response;
                            
                            if (model === 'grok-2-image-1212') {
                                response = await fetch('/api/grok_generate.php', {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify({
                                        prompt: prompt,
                                        n: 1
                                    })
                                });
                            } else if (model === 'siliconflow') {
                                response = await fetch('/api/siliconflow_generate.php', {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify({
                                        prompt: prompt
                                    })
                                });
                            } else if (model === 'flux') {
                                response = await fetch(API_ENDPOINTS.FLUX_GENERATE, {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify({
                                        prompt: prompt
                                    })
                                });
                            } else if (['dall-e-3', 'flux-pro', 'stable-diffusion-3.5', 'stable-diffusion-xl'].includes(model)) {
                                response = await fetch(API_ENDPOINTS.BOODLEBOX_GENERATE, {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify({
                                        prompt: prompt,
                                        n: 1,
                                        model: model,
                                        save_history: false
                                    })
                                });
                            }
                            
                            if (!response || !response.ok) {
                                throw new Error(`${getModelDisplayName(model)} API请求失败`);
                            }
                            
                            const data = await response.json();
                            
                            if (data.data && data.data.length > 0) {
                                // 保存结果
                                compareItems.push({
                                    model: model,
                                    modelName: getModelDisplayName(model),
                                    imageUrl: data.data[0].url
                                });
                                
                                // 更新进度条
                                progress += progressStep;
                                progressBar.style.width = `${progress}%`;
                            }
                        } catch (modelError) {
                            console.error(`模型 ${model} 生成失败:`, modelError);
                            
                            // 添加错误结果
                            compareItems.push({
                                model: model,
                                modelName: getModelDisplayName(model),
                                error: true,
                                errorMessage: modelError.message
                            });
                            
                            // 仍然更新进度条
                            progress += progressStep;
                            progressBar.style.width = `${progress}%`;
                        }
                    }
                    
                    // 完成比较，显示结果
                    // 设置提示词显示
                    comparePromptDisplay.textContent = `提示词: "${prompt}"`;
                    
                    // 创建比较项
                    compareItems.forEach(item => {
                        const compareItem = document.createElement('div');
                        compareItem.className = 'compare-item';
                        
                        const itemHeader = document.createElement('div');
                        itemHeader.className = 'compare-item-header';
                        
                        const itemTitle = document.createElement('div');
                        itemTitle.className = 'compare-item-title';
                        itemTitle.textContent = item.modelName;
                        
                        const itemSubtitle = document.createElement('div');
                        itemSubtitle.className = 'compare-item-subtitle';
                        itemSubtitle.textContent = item.error ? '生成失败' : '生成成功';
                        
                        itemHeader.appendChild(itemTitle);
                        itemHeader.appendChild(itemSubtitle);
                        compareItem.appendChild(itemHeader);
                        
                        const imageContainer = document.createElement('div');
                        imageContainer.className = 'compare-image-container';
                        
                        if (item.error) {
                            // 显示错误状态
                            const errorMsg = document.createElement('div');
                            errorMsg.className = 'compare-error';
                            errorMsg.innerHTML = `<i class="fas fa-exclamation-circle"></i><p>${item.errorMessage || '生成失败'}</p>`;
                            imageContainer.appendChild(errorMsg);
                        } else {
                            // 显示图像
                            const image = document.createElement('img');
                            image.className = 'compare-image';
                            image.src = item.imageUrl;
                            image.alt = `${item.modelName} 生成的图像`;
                            image.loading = 'lazy';
                            imageContainer.appendChild(image);
                        }
                        
                        compareItem.appendChild(imageContainer);
                        compareGrid.appendChild(compareItem);
                    });
                    
                    // 显示结果区域
                    compareResults.classList.add('active');
                    
                } catch (error) {
                    showError(`比较失败: ${error.message}`);
                } finally {
                    // 重置状态
                    startCompareBtn.disabled = false;
                    compareLoading.style.display = 'none';
                    progressBar.style.width = '0%';
                }
            });
            
            // 保存比较结果按钮
            document.querySelector('.save-comparison').addEventListener('click', function() {
                // 使用html2canvas库保存比较结果
                alert('导出比较图片功能即将上线，敬请期待！');
            });
            
            // 分享比较结果按钮
            document.querySelector('.share-comparison').addEventListener('click', function() {
                alert('分享功能即将上线，敬请期待！');
            });
            
            // AI提示词生成功能
            const promptGeneratorBtn = document.getElementById('prompt-generator-btn');
            const promptGeneratorModal = document.getElementById('prompt-generator-modal');
            const generatorTheme = document.getElementById('generator-theme');
            const generatorStyle = document.getElementById('generator-style');
            const generatorMood = document.getElementById('generator-mood');
            const generatorComplexity = document.getElementById('generator-complexity');
            const generatePromptBtn = document.getElementById('generate-prompt-btn');
            const generatorResults = document.querySelector('.generator-results');
            const generatorLoading = document.querySelector('.generator-loading');
            
            // 模拟的提示词生成数据库
            const promptTemplates = {
                nature: {
                    realistic: [
                        "壮观的{景色}山脉，被{氛围}的云海环绕，{复杂度}的细节",
                        "宁静的{氛围}湖泊，倒映着周围的群山和天空，{复杂度}的水面纹理",
                        "日落时分的{氛围}海滩，金色的阳光洒在海面上，{复杂度}的光影效果"
                    ],
                    impressionist: [
                        "印象派风格的{氛围}森林，斑驳的阳光透过树叶，{复杂度}的色彩变化",
                        "莫奈风格的{氛围}睡莲池塘，水面上漂浮着各色睡莲，{复杂度}的笔触",
                        "印象派的{氛围}田野风光，野花盛开，微风拂过，{复杂度}的质感"
                    ],
                    // 其他风格...
                },
                fantasy: {
                    cyberpunk: [
                        "未来科技{氛围}的幻想城市，霓虹灯闪烁，高耸的摩天大楼，{复杂度}的细节",
                        "赛博朋克风格的{氛围}地下世界，各种奇特的生物和机械混合体，{复杂度}的场景",
                        "科技感十足的{氛围}悬浮岛屿，被能量场包围，{复杂度}的建筑结构"
                    ],
                    oilpainting: [
                        "油画风格的{氛围}魔法森林，发光的植物和奇幻生物，{复杂度}的画面构成",
                        "厚重油彩表现的{氛围}龙族世界，飞龙盘旋在城堡上空，{复杂度}的场景",
                        "古典油画风格的{氛围}精灵王国，高耸的生命之树，{复杂度}的光影"
                    ],
                    // 其他风格...
                },
                // 其他主题...
            };
            
            // 复杂度描述
            const complexityDesc = {
                simple: "简约",
                moderate: "适中",
                complex: "复杂",
                verycomplex: "极其复杂和精细"
            };
            
            // 打开提示词生成器
            promptGeneratorBtn.addEventListener('click', function() {
                promptGeneratorModal.classList.add('active');
                generatorResults.classList.remove('active');
            });
            
            // 关闭提示词生成器模态框
            promptGeneratorModal.querySelector('.modal-close').addEventListener('click', function() {
                promptGeneratorModal.classList.remove('active');
            });
            
            // 点击模态框外部关闭
            promptGeneratorModal.addEventListener('click', function(e) {
                if (e.target === promptGeneratorModal) {
                    promptGeneratorModal.classList.remove('active');
                }
            });
            
            // 生成提示词
            generatePromptBtn.addEventListener('click', function() {
                const theme = generatorTheme.value;
                const style = generatorStyle.value;
                const mood = generatorMood.value;
                const complexity = generatorComplexity.value;
                
                // 显示加载中
                generatorResults.classList.remove('active');
                generatorLoading.classList.add('active');
                
                // 模拟API调用延迟
                setTimeout(() => {
                    generateCreativePrompts(theme, style, mood, complexity);
                    
                    // 隐藏加载中，显示结果
                    generatorLoading.classList.remove('active');
                    generatorResults.classList.add('active');
                }, 1500);
            });
            
            // 使用生成的提示词
            document.querySelectorAll('.generator-use-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = this.getAttribute('data-index');
                    const promptText = document.getElementById(`generated-prompt-${index}`).textContent;
                    
                    if (promptText) {
                        promptInput.value = promptText;
                        promptGeneratorModal.classList.remove('active');
                        promptInput.focus();
                    }
                });
            });
            
            // 生成创意提示词
            function generateCreativePrompts(theme, style, mood, complexity) {
                // 获取主题和风格的模板
                let templates = [];
                
                // 尝试精确匹配模板
                if (promptTemplates[theme] && promptTemplates[theme][style]) {
                    templates = promptTemplates[theme][style];
                } else {
                    // 如果没有精确匹配，随机选择一些可用模板
                    const availableThemes = Object.keys(promptTemplates);
                    const randomTheme = availableThemes[Math.floor(Math.random() * availableThemes.length)];
                    
                    const availableStyles = Object.keys(promptTemplates[randomTheme]);
                    const randomStyle = availableStyles[Math.floor(Math.random() * availableStyles.length)];
                    
                    templates = promptTemplates[randomTheme][randomStyle];
                }
                
                // 创建心情描述
                const moodDesc = {
                    peaceful: "平静",
                    dramatic: "戏剧性",
                    mysterious: "神秘",
                    happy: "欢快",
                    melancholy: "忧郁",
                    epic: "史诗般",
                    dreamy: "梦幻",
                    energetic: "充满活力"
                };
                
                // 创建主题描述
                const themeDesc = {
                    nature: ["山川", "湖泊", "河流", "森林", "海洋", "草原"],
                    fantasy: ["奇幻", "魔法", "神话", "异世界", "幻想"],
                    scifi: ["科幻", "未来", "太空", "外星"],
                    character: ["人物", "肖像", "角色", "英雄"],
                    animal: ["动物", "野生", "宠物", "生物"],
                    architecture: ["建筑", "城市", "结构", "都市"],
                    abstract: ["抽象", "概念", "几何", "非具象"],
                    oriental: ["东方", "亚洲", "中国", "日本"]
                };
                
                // 生成三个不同的提示词
                for (let i = 1; i <= 3; i++) {
                    // 随机选择一个模板
                    const template = templates[Math.floor(Math.random() * templates.length)];
                    
                    // 替换模板中的标记
                    let prompt = template
                        .replace('{氛围}', moodDesc[mood] || "")
                        .replace('{复杂度}', complexityDesc[complexity] || "");
                    
                    // 替换景色/主题描述
                    if (prompt.includes('{景色}')) {
                        const sceneryOptions = themeDesc[theme] || themeDesc.nature;
                        const scenery = sceneryOptions[Math.floor(Math.random() * sceneryOptions.length)];
                        prompt = prompt.replace('{景色}', scenery);
                    }
                    
                    // 添加风格描述（如果没有在模板中明确提到）
                    if (!prompt.toLowerCase().includes(style.toLowerCase())) {
                        const styleDesc = {
                            realistic: "写实风格",
                            impressionist: "印象派风格",
                            cyberpunk: "赛博朋克风格",
                            watercolor: "水彩风格",
                            oilpainting: "油画风格",
                            minimal: "极简主义风格",
                            cartoon: "卡通风格",
                            ink: "水墨国风",
                            digital: "数字艺术风格"
                        };
                        
                        prompt += `，${styleDesc[style] || ""}`;
                    }
                    
                    // 更新提示词显示
                    document.getElementById(`generated-prompt-${i}`).textContent = prompt;
                }
            }
            
            // 提示词工具下拉菜单
            const promptToolsBtn = document.getElementById('prompt-tools-btn');
            const promptToolsMenu = document.querySelector('.prompt-tools-menu');
            
            promptToolsBtn.addEventListener('click', function() {
                this.classList.toggle('active');
                promptToolsMenu.classList.toggle('visible');
            });
            
            // 点击外部关闭下拉菜单
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.prompt-tools-dropdown')) {
                    promptToolsBtn.classList.remove('active');
                    promptToolsMenu.classList.remove('visible');
                }
            });
            
            // 优化助手和生成器按钮保持原来的逻辑
            document.getElementById('prompt-assistant-btn').addEventListener('click', function() {
                promptToolsBtn.classList.remove('active');
                promptToolsMenu.classList.remove('visible');
                promptAssistantModal.classList.add('active');
                // 重置选中状态
                assistantChips.forEach(chip => chip.classList.remove('selected'));
                // 更新预览
                updateOptimizedPrompt();
            });
            
            document.getElementById('prompt-generator-btn').addEventListener('click', function() {
                promptToolsBtn.classList.remove('active');
                promptToolsMenu.classList.remove('visible');
                promptGeneratorModal.classList.add('active');
                generatorResults.classList.remove('active');
            });
        });
    </script>
</body>
</html>